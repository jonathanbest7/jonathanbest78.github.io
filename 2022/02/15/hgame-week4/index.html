<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color" content="#3367D6"/>
  <link rel="apple-touch-icon" href="/icons-192.png">
  <link rel="manifest" href="/manifest.json">
  
  <meta name="generator" content="Hexo 5.4.0">

  

  

  
    <meta name="author" content="Jonathan">
  

  

  

  <title>hgame-week4 | Jonathan的小窝</title>

  

  
    <link rel="shortcut icon" href="/bitbug_favicon.ico">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@1.1.3/index.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs@9.16.2/styles/monokai.css">
  

  
<link rel="stylesheet" href="/css/style.css">

</head>
<body>
  <div class="root-container">
    
<!-- header container -->
<header class="header-container post">
  
    <div class="post-image" style="background-image: url(https://qiniu.sukoshi.xyz/src/images/68686407_p0.jpg)"></div>
  

  <!-- navbar -->
<nav class="navbar">
  <div class="navbar-content">
    <!-- logo -->
    <div class="navbar-logo">
      <a href="/">
        
          Jonathan的小窝
        
      </a>
    </div>
    <!-- link -->
    <div class="navbar-link">
      <div class="navbar-btn">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <ul class="navbar-list">
        
          <li class="navbar-list-item"><a href="/">首页</a></li>
        
          <li class="navbar-list-item"><a href="/links">友链</a></li>
        
          <li class="navbar-list-item"><a href="/about">关于</a></li>
        
      </ul>
    </div>
  </div>
</nav>

  
  

  
  

  
  

  
  

  
  
    <div class="header-content">
      <div class="post-text layout-block">
        <div class="layout-margin">
          <h1 class="title-wrap">hgame-week4</h1>
          <h2 class="title-sub-wrap">
            <strong>Jonathan</strong>
            <span>发布于</span>
            <time  class="article-date" datetime="2022-02-15T04:11:20.000Z" itemprop="datePublished">2022-02-15</time>
          </h2>
          <ul class="wrap-list dark">
  
</ul>
          <ul class="wrap-list dark">
  
</ul>
        </div>
      </div>
    </div>
  

  
  
  
</header>

    <!-- 文章 -->

<!-- 文章内容 -->
<div class="body-container">
  <article class="content-container layout-block post-container">
    <div class="article-info">
      
      
      
      
      <section class="article-entry markdown-body layout-margin content-padding--large soft-size--large soft-style--box">
        <h1 id="hgame-week4"><a href="#hgame-week4" class="headerlink" title="hgame-week4"></a>hgame-week4</h1><h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime</span><br><span class="line">from libnum import s2n</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">p = getPrime(256)</span><br><span class="line">a = getPrime(256)</span><br><span class="line">b = getPrime(256)</span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">m = E.random_point()</span><br><span class="line">G = E.random_point()</span><br><span class="line">k = getPrime(256)</span><br><span class="line">K = k * G</span><br><span class="line">r = getPrime(256)</span><br><span class="line">c1 = m + r * K</span><br><span class="line">c2 = r * G</span><br><span class="line">cipher_left = s2n(flag[:len(flag)//2]) * m[0]</span><br><span class="line">cipher_right = s2n(flag[len(flag)//2:]) * m[1]</span><br><span class="line"></span><br><span class="line">print(f&quot;p = &#123;p&#125;&quot;)</span><br><span class="line">print(f&quot;a = &#123;a&#125;&quot;)</span><br><span class="line">print(f&quot;b = &#123;b&#125;&quot;)</span><br><span class="line">print(f&quot;k = &#123;k&#125;&quot;)</span><br><span class="line">print(f&quot;E = &#123;E&#125;&quot;)</span><br><span class="line">print(f&quot;c1 = &#123;c1&#125;&quot;)</span><br><span class="line">print(f&quot;c2 = &#123;c2&#125;&quot;)</span><br><span class="line">print(f&quot;cipher_left = &#123;cipher_left&#125;&quot;)</span><br><span class="line">print(f&quot;cipher_right = &#123;cipher_right&#125;&quot;)</span><br></pre></td></tr></table></figure>

<p>这个题就是将flag分成了两份，我们只用求出m就好了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">74997021559434065975272431626618720725838473091721936616560359000648651891507</span></span><br><span class="line">a = <span class="number">61739043730332859978236469007948666997510544212362386629062032094925353519657</span></span><br><span class="line">b = <span class="number">87821782818477817609882526316479721490919815013668096771992360002467657827319</span></span><br><span class="line">k = <span class="number">93653874272176107584459982058527081604083871182797816204772644509623271061231</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">c1 = E(<span class="number">14455613666211899576018835165132438102011988264607146511938249744871964946084</span>, <span class="number">25506582570581289714612640493258299813803157561796247330693768146763035791942</span>)</span><br><span class="line">c2 = E(<span class="number">37554871162619456709183509122673929636457622251880199235054734523782483869931</span>, <span class="number">71392055540616736539267960989304287083629288530398474590782366384873814477806</span>)</span><br><span class="line">cipher_left = <span class="number">68208062402162616009217039034331142786282678107650228761709584478779998734710</span></span><br><span class="line">cipher_right = <span class="number">27453988545002384546706933590432585006240439443312571008791835203660152890619</span></span><br><span class="line">m = c1 - k*c2</span><br><span class="line">cipher_left = cipher_left * inverse_mod(<span class="built_in">int</span>(m[<span class="number">0</span>]), p) % p</span><br><span class="line">cipher_right = cipher_right * inverse_mod(<span class="built_in">int</span>(m[<span class="number">1</span>]), p) % p</span><br><span class="line"><span class="built_in">print</span>(cipher_left, cipher_right)</span><br></pre></td></tr></table></figure>

<p>这个要用sage来解，并不是python。。。。坑死我，找到了个在线解。<a target="_blank" rel="noopener" href="https://sagecell.sagemath.org/">https://sagecell.sagemath.org/</a></p>
<p>得到：493033149237009446036260 127480900256551022095393917</p>
<p>用n2s解密一下，就行。</p>
<p>hgame{Ecc$is!sO@HaRd}</p>
<h3 id="PRNG"><a href="#PRNG" class="headerlink" title="PRNG"></a>PRNG</h3><p>这个题极客也有，也没有魔改，直接那脚本：from libnum import n2s </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line"><span class="keyword">from</span> PRNG <span class="keyword">import</span> PRNG </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TemperInverser</span>:</span> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__inverse_right_shift_xor</span>(<span class="params">self, value, shift</span>):</span> </span><br><span class="line">        i, result = <span class="number">0</span>, <span class="number">0</span> </span><br><span class="line">        <span class="keyword">while</span> i * shift &lt; <span class="number">32</span>: </span><br><span class="line">            part_mask = ((<span class="number">0xffffffff</span> &lt;&lt; (<span class="number">32</span> - shift)) &amp; <span class="number">0xffffffff</span>) &gt;&gt; (i * shift) </span><br><span class="line">            part = value &amp; part_mask </span><br><span class="line">            value ^= part &gt;&gt; shift </span><br><span class="line">            result |= part </span><br><span class="line">            i += <span class="number">1</span> </span><br><span class="line">        <span class="keyword">return</span> result </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__inverse_left_shift_xor</span>(<span class="params">self, value, shift, mask</span>):</span> </span><br><span class="line">        i, result = <span class="number">0</span>, <span class="number">0</span> </span><br><span class="line">        <span class="keyword">while</span> i * shift &lt; <span class="number">32</span>: </span><br><span class="line">            part_mask = (<span class="number">0xffffffff</span> &gt;&gt; (<span class="number">32</span> - shift)) &lt;&lt; (i * shift) </span><br><span class="line">            part = value &amp; part_mask </span><br><span class="line">            value ^= (part &lt;&lt; shift) &amp; mask </span><br><span class="line">            result |= part </span><br><span class="line">            i += <span class="number">1</span> </span><br><span class="line">            <span class="keyword">return</span> result </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self, tempered</span>):</span> </span><br><span class="line">        value = tempered </span><br><span class="line">        value = self.__inverse_right_shift_xor(value, <span class="number">18</span>) </span><br><span class="line">        value = self.__inverse_left_shift_xor(value, <span class="number">15</span>, <span class="number">0xefc60000</span>) </span><br><span class="line">        value = self.__inverse_left_shift_xor(value, <span class="number">7</span>, <span class="number">0x9d2c5680</span>) </span><br><span class="line">        value = self.__inverse_right_shift_xor(value, <span class="number">11</span>) </span><br><span class="line">        <span class="keyword">return</span> value </span><br><span class="line">        </span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">MersenneTwisterCracker</span>:</span> </span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, data</span>):</span> </span><br><span class="line">                inverser = TemperInverser() </span><br><span class="line">                self.__mt = PRNG(<span class="number">0</span>) </span><br><span class="line">                self.__mt.load_register(<span class="built_in">list</span>(<span class="built_in">map</span>(inverser, data))) </span><br><span class="line">            </span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self</span>):</span> </span><br><span class="line">                <span class="keyword">return</span> self.__mt() </span><br><span class="line">data = [<span class="number">888058162</span>, <span class="number">3094055443</span>, <span class="number">1404990361</span>, <span class="number">1012543603</span>, <span class="number">448723884</span>, <span class="number">2580444236</span>, <span class="number">201608779</span>, <span class="number">1062995809</span>, <span class="number">1348787313</span>, <span class="number">2980019361</span>, <span class="number">2245025385</span>, <span class="number">494977308</span>, <span class="number">4042503808</span>, <span class="number">275744301</span>, <span class="number">406611131</span>, <span class="number">142226472</span>, <span class="number">3871761759</span>, <span class="number">3888795536</span>, <span class="number">2617489687</span>, <span class="number">1220227074</span>, <span class="number">342928858</span>, <span class="number">3728958896</span>, <span class="number">1477077966</span>, <span class="number">1433151407</span>, <span class="number">1119405037</span>, <span class="number">330145973</span>, <span class="number">3547181160</span>, <span class="number">2123007249</span>, <span class="number">3739964132</span>, <span class="number">1794129718</span>, <span class="number">2739743522</span>, <span class="number">2291585121</span>, <span class="number">3013727731</span>, <span class="number">1536788463</span>, <span class="number">247633572</span>, <span class="number">408079265</span>, <span class="number">3025555185</span>, <span class="number">1604681922</span>, <span class="number">2848997116</span>, <span class="number">3646041955</span>, <span class="number">1059445774</span>, <span class="number">2849764176</span>, <span class="number">2638965889</span>, <span class="number">1232303180</span>, <span class="number">759521642</span>, <span class="number">2257008531</span>, <span class="number">3932082254</span>, <span class="number">1052428413</span>, <span class="number">4017559916</span>, <span class="number">3505694223</span>, <span class="number">1418363972</span>, <span class="number">477751107</span>, <span class="number">4266295945</span>, <span class="number">3832138928</span>, <span class="number">245251422</span>, <span class="number">1964323108</span>, <span class="number">2453472918</span>, <span class="number">3029032760</span>, <span class="number">323619451</span>, <span class="number">2548825339</span>, <span class="number">3410027991</span>, <span class="number">278143595</span>, <span class="number">816124107</span>, <span class="number">245705463</span>, <span class="number">4173686519</span>, <span class="number">4100831820</span>, <span class="number">3599257115</span>, <span class="number">2274885516</span>, <span class="number">3954736394</span>, <span class="number">198254482</span>, <span class="number">1050449178</span>, <span class="number">3933150558</span>, <span class="number">899220021</span>, <span class="number">597474632</span>, <span class="number">1823539097</span>, <span class="number">3340511318</span>, <span class="number">2144918682</span>, <span class="number">2310527451</span>, <span class="number">264391694</span>, <span class="number">69923676</span>, <span class="number">3266017310</span>, <span class="number">3199627722</span>, <span class="number">4035962745</span>, <span class="number">932969905</span>, <span class="number">2832951013</span>, <span class="number">2182887504</span>, <span class="number">1374919242</span>, <span class="number">2978944795</span>, <span class="number">1840647233</span>, <span class="number">3510878043</span>, <span class="number">3250544991</span>, <span class="number">4255542321</span>, <span class="number">804377010</span>, <span class="number">1286980519</span>, <span class="number">1980427321</span>, <span class="number">2893246724</span>, <span class="number">1745353148</span>, <span class="number">1406140332</span>, <span class="number">4101848568</span>, <span class="number">3227434698</span>, <span class="number">1869729934</span>, <span class="number">2638181242</span>, <span class="number">1270111849</span>, <span class="number">2387910792</span>, <span class="number">3411542702</span>, <span class="number">2793303435</span>, <span class="number">2455337459</span>, <span class="number">2802808043</span>, <span class="number">2418872990</span>, <span class="number">1043274549</span>, <span class="number">144911746</span>, <span class="number">2312236858</span>, <span class="number">780373658</span>, <span class="number">1527499811</span>, <span class="number">3402753408</span>, <span class="number">2617924770</span>, <span class="number">1659648360</span>, <span class="number">2714315441</span>, <span class="number">4202103851</span>, <span class="number">244677433</span>, <span class="number">1963258902</span>, <span class="number">3851363324</span>, <span class="number">3454195559</span>, <span class="number">813228826</span>, <span class="number">3944899734</span>, <span class="number">3697685234</span>, <span class="number">1613584167</span>, <span class="number">1874570879</span>, <span class="number">1592343033</span>, <span class="number">4194241173</span>, <span class="number">551902434</span>, <span class="number">3460909265</span>, <span class="number">4122075287</span>, <span class="number">176665387</span>, <span class="number">152849760</span>, <span class="number">3593212904</span>, <span class="number">952880017</span>, <span class="number">1793357635</span>, <span class="number">2052902220</span>, <span class="number">807859486</span>, <span class="number">334839380</span>, <span class="number">3485132343</span>, <span class="number">2113403566</span>, <span class="number">3259106798</span>, <span class="number">1443078482</span>, <span class="number">2434820318</span>, <span class="number">1347902400</span>, <span class="number">2344061487</span>, <span class="number">141766876</span>, <span class="number">2641586235</span>, <span class="number">287277458</span>, <span class="number">2385094526</span>, <span class="number">1510128758</span>, <span class="number">348957861</span>, <span class="number">2861038633</span>, <span class="number">1135611795</span>, <span class="number">4289024199</span>, <span class="number">1021202791</span>, <span class="number">2460872523</span>, <span class="number">3837050794</span>, <span class="number">4092005952</span>, <span class="number">52622948</span>, <span class="number">387056916</span>, <span class="number">3102913460</span>, <span class="number">4098715316</span>, <span class="number">154916530</span>, <span class="number">2890197932</span>, <span class="number">1441566957</span>, <span class="number">2368779800</span>, <span class="number">271808452</span>, <span class="number">3566810840</span>, <span class="number">2227022452</span>, <span class="number">316480679</span>, <span class="number">603893066</span>, <span class="number">2121889912</span>, <span class="number">4208763743</span>, <span class="number">3098334580</span>, <span class="number">721958838</span>, <span class="number">3848020801</span>, <span class="number">1029884135</span>, <span class="number">832405094</span>, <span class="number">2276817394</span>, <span class="number">981553190</span>, <span class="number">246940442</span>, <span class="number">1069231974</span>, <span class="number">3275216531</span>, <span class="number">58945988</span>, <span class="number">4100121200</span>, <span class="number">230446475</span>, <span class="number">2396021649</span>, <span class="number">4608139</span>, <span class="number">3468707911</span>, <span class="number">3249498323</span>, <span class="number">315898153</span>, <span class="number">3280797960</span>, <span class="number">388108494</span>, <span class="number">1110548082</span>, <span class="number">2357147660</span>, <span class="number">2336724751</span>, <span class="number">4047583630</span>, <span class="number">2108667879</span>, <span class="number">2784078579</span>, <span class="number">1170844412</span>, <span class="number">3920262445</span>, <span class="number">3564073655</span>, <span class="number">590490534</span>, <span class="number">1645945278</span>, <span class="number">2487463163</span>, <span class="number">434409966</span>, <span class="number">1563546251</span>, <span class="number">888601967</span>, <span class="number">1913513318</span>, <span class="number">1327448740</span>, <span class="number">2504517969</span>, <span class="number">304688984</span>, <span class="number">1443685450</span>, <span class="number">4040619940</span>, <span class="number">3601250858</span>, <span class="number">4097529433</span>, <span class="number">4260590151</span>, <span class="number">575843085</span>, <span class="number">1114360271</span>, <span class="number">2186035374</span>, <span class="number">2821388594</span>, <span class="number">3763206347</span>, <span class="number">4283149630</span>, <span class="number">4097168778</span>, <span class="number">1924538037</span>, <span class="number">3272064650</span>, <span class="number">1689166701</span>, <span class="number">1352331676</span>, <span class="number">520525342</span>, <span class="number">2954296222</span>, <span class="number">2629516330</span>, <span class="number">3674317458</span>, <span class="number">231784130</span>, <span class="number">1930132422</span>, <span class="number">4169222397</span>, <span class="number">1638784833</span>, <span class="number">1245667959</span>, <span class="number">1253759350</span>, <span class="number">1154928813</span>, <span class="number">66021172</span>, <span class="number">3217915692</span>, <span class="number">4159785573</span>, <span class="number">3798512628</span>, <span class="number">2945489695</span>, <span class="number">700725579</span>, <span class="number">3940231312</span>, <span class="number">1960713279</span>, <span class="number">3289722468</span>, <span class="number">2970919839</span>, <span class="number">1356139680</span>, <span class="number">1141841193</span>, <span class="number">629177162</span>, <span class="number">3696263539</span>, <span class="number">1084872874</span>, <span class="number">4294077062</span>, <span class="number">1115547807</span>, <span class="number">3421092527</span>, <span class="number">611575307</span>, <span class="number">7808529</span>, <span class="number">2784523837</span>, <span class="number">1267307982</span>, <span class="number">1538837032</span>, <span class="number">4038330055</span>, <span class="number">3262951566</span>, <span class="number">3139820067</span>, <span class="number">1249725729</span>, <span class="number">757191354</span>, <span class="number">3025188720</span>, <span class="number">291705345</span>, <span class="number">575676661</span>, <span class="number">3023956263</span>, <span class="number">1045504889</span>, <span class="number">205204207</span>, <span class="number">1777650027</span>, <span class="number">1956698897</span>, <span class="number">996147619</span>, <span class="number">1470431</span>, <span class="number">2275722398</span>, <span class="number">2666078800</span>, <span class="number">470333070</span>, <span class="number">1306693906</span>, <span class="number">2968672077</span>, <span class="number">2476023772</span>, <span class="number">2645573325</span>, <span class="number">3939390068</span>, <span class="number">2874886754</span>, <span class="number">4226430090</span>, <span class="number">2290851636</span>, <span class="number">3707585663</span>, <span class="number">109770347</span>, <span class="number">127373916</span>, <span class="number">815817847</span>, <span class="number">1565834917</span>, <span class="number">636869794</span>, <span class="number">4062053412</span>, <span class="number">583594822</span>, <span class="number">3782553071</span>, <span class="number">3293311273</span>, <span class="number">2801932604</span>, <span class="number">2647080862</span>, <span class="number">1514083254</span>, <span class="number">3534640458</span>, <span class="number">342361004</span>, <span class="number">3266111849</span>, <span class="number">2157351044</span>, <span class="number">1851728420</span>, <span class="number">3412596866</span>, <span class="number">2793236910</span>, <span class="number">3758306563</span>, <span class="number">1799548561</span>, <span class="number">952631672</span>, <span class="number">912455646</span>, <span class="number">2894404493</span>, <span class="number">2194084105</span>, <span class="number">119615608</span>, <span class="number">2071058651</span>, <span class="number">1524462411</span>, <span class="number">900936180</span>, <span class="number">3697554830</span>, <span class="number">3501838982</span>, <span class="number">2874465656</span>, <span class="number">2501478689</span>, <span class="number">1069024222</span>, <span class="number">3135689372</span>, <span class="number">1168458702</span>, <span class="number">1966524629</span>, <span class="number">36400028</span>, <span class="number">2704775319</span>, <span class="number">4030739700</span>, <span class="number">3985599923</span>, <span class="number">2778920518</span>, <span class="number">2669538325</span>, <span class="number">1951594393</span>, <span class="number">795749079</span>, <span class="number">665593501</span>, <span class="number">3007338649</span>, <span class="number">1535343068</span>, <span class="number">2031873237</span>, <span class="number">3202423789</span>, <span class="number">560224943</span>, <span class="number">1290838890</span>, <span class="number">2545130826</span>, <span class="number">695695377</span>, <span class="number">3048615291</span>, <span class="number">1957903923</span>, <span class="number">1986693779</span>, <span class="number">2594986519</span>, <span class="number">3396211122</span>, <span class="number">2625687092</span>, <span class="number">575329062</span>, <span class="number">2852671310</span>, <span class="number">3472799759</span>, <span class="number">715985207</span>, <span class="number">1660331651</span>, <span class="number">958648594</span>, <span class="number">305711662</span>, <span class="number">75621441</span>, <span class="number">548447557</span>, <span class="number">2473842353</span>, <span class="number">2110558182</span>, <span class="number">3321750402</span>, <span class="number">2415793078</span>, <span class="number">815198061</span>, <span class="number">1258834500</span>, <span class="number">972966677</span>, <span class="number">3267046345</span>, <span class="number">2923564883</span>, <span class="number">518207679</span>, <span class="number">1662309775</span>, <span class="number">278933232</span>, <span class="number">4294256390</span>, <span class="number">2444117793</span>, <span class="number">2241879973</span>, <span class="number">3915962245</span>, <span class="number">3836532482</span>, <span class="number">3449260219</span>, <span class="number">1092128833</span>, <span class="number">3177300913</span>, <span class="number">874588042</span>, <span class="number">1185436845</span>, <span class="number">2064537788</span>, <span class="number">364292705</span>, <span class="number">3802247898</span>, <span class="number">3122264959</span>, <span class="number">186651829</span>, <span class="number">2789447523</span>, <span class="number">797964681</span>, <span class="number">897671294</span>, <span class="number">1504956985</span>, <span class="number">2294012382</span>, <span class="number">3916152546</span>, <span class="number">177325516</span>, <span class="number">2741945226</span>, <span class="number">4188655695</span>, <span class="number">2738134558</span>, <span class="number">557326292</span>, <span class="number">1625014790</span>, <span class="number">2945266389</span>, <span class="number">1843516240</span>, <span class="number">644046640</span>, <span class="number">3853456819</span>, <span class="number">3456105042</span>, <span class="number">3467742754</span>, <span class="number">2885173326</span>, <span class="number">812088996</span>, <span class="number">1238970324</span>, <span class="number">766072156</span>, <span class="number">2675925963</span>, <span class="number">1667463511</span>, <span class="number">2808303112</span>, <span class="number">1638756770</span>, <span class="number">260047996</span>, <span class="number">1117661655</span>, <span class="number">346883777</span>, <span class="number">2268712532</span>, <span class="number">1904918136</span>, <span class="number">513102466</span>, <span class="number">1024624509</span>, <span class="number">2154277089</span>, <span class="number">4147814745</span>, <span class="number">3681688842</span>, <span class="number">2233642964</span>, <span class="number">3135674550</span>, <span class="number">1259551210</span>, <span class="number">3286048484</span>, <span class="number">4271168802</span>, <span class="number">4227197378</span>, <span class="number">3310884772</span>, <span class="number">2063705584</span>, <span class="number">791399172</span>, <span class="number">4069266828</span>, <span class="number">1511606526</span>, <span class="number">1047713396</span>, <span class="number">615906401</span>, <span class="number">2805111822</span>, <span class="number">499223767</span>, <span class="number">740832370</span>, <span class="number">351782725</span>, <span class="number">2258776891</span>, <span class="number">1837046713</span>, <span class="number">3969757168</span>, <span class="number">2873152110</span>, <span class="number">4214869805</span>, <span class="number">3416771254</span>, <span class="number">2527945969</span>, <span class="number">3279116532</span>, <span class="number">1217038009</span>, <span class="number">4014402228</span>, <span class="number">3696705795</span>, <span class="number">1877774112</span>, <span class="number">3928347956</span>, <span class="number">959715122</span>, <span class="number">1612979629</span>, <span class="number">4045688071</span>, <span class="number">2403021083</span>, <span class="number">424891533</span>, <span class="number">1887765641</span>, <span class="number">2090726432</span>, <span class="number">2897940431</span>, <span class="number">268403838</span>, <span class="number">3447542890</span>, <span class="number">575011346</span>, <span class="number">2559143209</span>, <span class="number">532649938</span>, <span class="number">3625398853</span>, <span class="number">2077769196</span>, <span class="number">1598653066</span>, <span class="number">3104923961</span>, <span class="number">3594500739</span>, <span class="number">675029389</span>, <span class="number">579180583</span>, <span class="number">2024117612</span>, <span class="number">1351780728</span>, <span class="number">654841863</span>, <span class="number">769835263</span>, <span class="number">1431012736</span>, <span class="number">2369300321</span>, <span class="number">4157341752</span>, <span class="number">1968305076</span>, <span class="number">2086919554</span>, <span class="number">3075265115</span>, <span class="number">2128974418</span>, <span class="number">3144501489</span>, <span class="number">3993066430</span>, <span class="number">1121959765</span>, <span class="number">1373765135</span>, <span class="number">4232964375</span>, <span class="number">2264170351</span>, <span class="number">11814235</span>, <span class="number">1797654983</span>, <span class="number">3382686935</span>, <span class="number">2541491040</span>, <span class="number">3540726136</span>, <span class="number">1330685654</span>, <span class="number">4123114026</span>, <span class="number">2521290625</span>, <span class="number">3357439706</span>, <span class="number">3331159097</span>, <span class="number">2298656231</span>, <span class="number">3446738535</span>, <span class="number">290996369</span>, <span class="number">3020977553</span>, <span class="number">849241175</span>, <span class="number">3469792522</span>, <span class="number">4119898263</span>, <span class="number">1339695718</span>, <span class="number">2125209134</span>, <span class="number">3620160106</span>, <span class="number">1063375386</span>, <span class="number">1656465852</span>, <span class="number">2505508266</span>, <span class="number">3958528861</span>, <span class="number">3497875682</span>, <span class="number">3112358345</span>, <span class="number">3675237811</span>, <span class="number">1109625127</span>, <span class="number">2672368219</span>, <span class="number">1983461371</span>, <span class="number">3579663373</span>, <span class="number">1969195060</span>, <span class="number">225618775</span>, <span class="number">653511251</span>, <span class="number">3508369415</span>, <span class="number">4127429853</span>, <span class="number">828877800</span>, <span class="number">4286770015</span>, <span class="number">1474706143</span>, <span class="number">870777512</span>, <span class="number">804917422</span>, <span class="number">3913439258</span>, <span class="number">2433991646</span>, <span class="number">2742831709</span>, <span class="number">4289045475</span>, <span class="number">2899508500</span>, <span class="number">185462457</span>, <span class="number">4178107803</span>, <span class="number">2671443073</span>, <span class="number">2701796854</span>, <span class="number">1170522896</span>, <span class="number">1599880638</span>, <span class="number">1410722361</span>, <span class="number">3977867960</span>, <span class="number">1263177666</span>, <span class="number">2159508450</span>, <span class="number">2704509681</span>, <span class="number">1540819416</span>, <span class="number">1836499452</span>, <span class="number">1667451095</span>, <span class="number">3799477506</span>, <span class="number">157146600</span>, <span class="number">3717470672</span>, <span class="number">89865758</span>, <span class="number">3815588203</span>, <span class="number">1929105788</span>, <span class="number">861643665</span>, <span class="number">684514017</span>, <span class="number">3519778437</span>, <span class="number">2712956097</span>, <span class="number">1004423983</span>, <span class="number">1540346552</span>, <span class="number">2617389519</span>, <span class="number">2754800020</span>, <span class="number">870994822</span>, <span class="number">1702399767</span>, <span class="number">3526294475</span>, <span class="number">3251290865</span>, <span class="number">2365820957</span>, <span class="number">1915675760</span>, <span class="number">1828371367</span>, <span class="number">3737352795</span>, <span class="number">2511512700</span>, <span class="number">1080446781</span>, <span class="number">2565191059</span>, <span class="number">2412448535</span>, <span class="number">3719988291</span>, <span class="number">1434643780</span>, <span class="number">4163492408</span>, <span class="number">1359345746</span>, <span class="number">1457543102</span>, <span class="number">2389534435</span>, <span class="number">2800945892</span>, <span class="number">2646700564</span>, <span class="number">1719588203</span>, <span class="number">999665519</span>, <span class="number">3120652917</span>, <span class="number">1800116770</span>, <span class="number">3247314137</span>, <span class="number">4261164550</span>, <span class="number">1503462948</span>, <span class="number">3017762189</span>, <span class="number">263481701</span>, <span class="number">1754772485</span>, <span class="number">869168639</span>, <span class="number">604192231</span>, <span class="number">498759780</span>, <span class="number">2602535702</span>, <span class="number">3346756344</span>, <span class="number">2836267314</span>, <span class="number">2073734260</span>, <span class="number">3445425559</span>, <span class="number">4051271696</span>, <span class="number">1647518162</span>, <span class="number">401835417</span>, <span class="number">1968629992</span>, <span class="number">2854677838</span>, <span class="number">2381566661</span>, <span class="number">3144829468</span>, <span class="number">519547510</span>, <span class="number">3058642603</span>, <span class="number">3944140819</span>, <span class="number">1248923220</span>, <span class="number">1050321901</span>, <span class="number">3218172519</span>, <span class="number">376999645</span>, <span class="number">184187381</span>, <span class="number">3837095155</span>, <span class="number">3363256702</span>, <span class="number">751966993</span>, <span class="number">3419533016</span>, <span class="number">4028456468</span>, <span class="number">1156797460</span>]</span><br><span class="line">cipher = [<span class="number">3437104340</span>, <span class="number">508103176</span>, <span class="number">1635844121</span>, <span class="number">878522509</span>, <span class="number">1923790547</span>, <span class="number">1727955782</span>, <span class="number">1371509208</span>, <span class="number">3182873539</span>, <span class="number">156878129</span>, <span class="number">1757777801</span>, <span class="number">1472806960</span>, <span class="number">3486450735</span>, <span class="number">2307527058</span>, <span class="number">2950814692</span>, <span class="number">1817110380</span>, <span class="number">372493821</span>, <span class="number">729662950</span>, <span class="number">2366747255</span>, <span class="number">774823385</span>, <span class="number">387513980</span>, <span class="number">1444397883</span>]</span><br><span class="line">mt = MersenneTwisterCracker(data) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">b&quot;&quot;</span>.join(<span class="built_in">map</span>(n2s,[part ^ mt() <span class="keyword">for</span> part <span class="keyword">in</span> cipher])))</span><br></pre></td></tr></table></figure>

<p>参考wp的脚本</p>
<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><p>由于最后太忙了，没打，做个复现，这周属实没上周难。</p>
<h3 id="WOW"><a href="#WOW" class="headerlink" title="WOW"></a>WOW</h3><p><img src="/2022/02/15/hgame-week4/image-20220222150429334.png"></p>
<p>我们能看出flag是32位，那么我们先输入一个flag动调一下，发现是要和48行的数组进行比对，然后进行完，发现buf2又恢复输入了，那么可猜测第二次循环是解密过程，那么属于很想rc4的动调。</p>
<p>我们在48行设断点，然后输入32个a，然后找到buf2的位置，将unk中的值pasta data一下，然后调试到后面就出来了。</p>
<p><img src="/2022/02/15/hgame-week4/image-20220222150718354.png"></p>
<p>后悔没做，这500分不是轻轻松松。。。</p>
<h3 id="ezvm"><a href="#ezvm" class="headerlink" title="ezvm"></a>ezvm</h3><p>这道题很恶心，步骤很多，要一步一步调试，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  sub_401A40(argc, argv, envp);</span><br><span class="line">  <span class="built_in">std</span>::__ostream_insert&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;libstdc___6__ZSt4cout, <span class="string">&quot;input your flag:&quot;</span>, <span class="number">16</span>i64);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;libstdc___6__ZSt4cout);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = dword_404020[dword_404020[<span class="number">0</span>] + <span class="number">109</span>];</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">-1</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">switch</span> ( v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        sub_401550(&amp;dword_404020[<span class="number">3</span>], (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)&amp;dword_404020[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        sub_401555(&amp;dword_404020[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        sub_401559(&amp;dword_404020[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        sub_40156C(&amp;dword_404020[<span class="number">3</span>], &amp;dword_404020[<span class="number">7</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        sub_401578();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        sub_40159B();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        sub_4015BE();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        sub_401605();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        sub_40161B();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">        sub_401631();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">        sub_401647();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">        sub_40165D();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">        sub_40169E((<span class="keyword">unsigned</span> <span class="keyword">int</span>)dword_404020[<span class="number">6</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">13</span>:</span><br><span class="line">        sub_4016AE(dword_404020[<span class="number">6</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">14</span>:</span><br><span class="line">        sub_401571((<span class="keyword">unsigned</span> <span class="keyword">int</span>)dword_404020[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">15</span>:</span><br><span class="line">        sub_401673(dword_404020[<span class="number">3</span>], dword_404020[<span class="number">5</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">        sub_4016BE(&amp;dword_404020[<span class="number">3</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">17</span>:</span><br><span class="line">        sub_4016D3(&amp;dword_404020[<span class="number">3</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">18</span>:</span><br><span class="line">        sub_4016E4();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">19</span>:</span><br><span class="line">        sub_40171A();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">20</span>:</span><br><span class="line">        sub_401733();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">21</span>:</span><br><span class="line">        sub_40155D();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++dword_404020[<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第一次先经过一波4 —&gt; 1 —&gt; 15 —&gt; 13 —&gt; 16，而这个会经历你输入的flag长度的次数，由于后面有一个0x20，那么可以推测flag长度为32位，那么这些步骤总的来说我认为是将我们输入的flag传到规定的地址。</p>
<p>下面是16函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __fastcall <span class="title">sub_4016BE</span><span class="params">(<span class="keyword">int</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  result = getchar();</span><br><span class="line">  *a1 = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很显然是输入单字符。</p>
<p>下面是15函数，显然是个compare函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall <span class="title">sub_401673</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 == a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    dword_404040 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( a1 &gt;= a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a1 &gt; a2 )</span><br><span class="line">      dword_404040 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    dword_404040 = <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在前31次的调试中我发现a2这个是0xA，即回车。</p>
<p>然后经过32次后，我们能在虚拟地址中看到上传的flag。</p>
<p><img src="/2022/02/15/hgame-week4/image-20220222161654309.png"></p>
<p>接下来进行2 —&gt; 18 —&gt; 8 —&gt; 18 —&gt; 9 —&gt; 0 —&gt; 4 —&gt; 15 —&gt; 13，只进行了一次，对于input并无改变。</p>
<p>接下来在调试发现又是循环而且，input处的值发生了变化！</p>
<p>18 —&gt; 9 —&gt; 18 —&gt; 10 —&gt; 19 —&gt; 18 —&gt; 11 —&gt; 21 —&gt; 3 —&gt; 20 —&gt; 1 —&gt; 0 —&gt; 15 —&gt; 13 —&gt; 19 —→ 18 —&gt; 11 —&gt; 21 —&gt; 3 —&gt; 20 —&gt; 1 —&gt; 0 —&gt; ……</p>
<p>我们直接找到几个重要的函数比如21</p>
<p>下面是21的函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">int64 <span class="title">sub_40155D</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(<span class="number">2</span> * dword_40402C);</span><br><span class="line">  dword_40402C *= <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>经过动调发现这个地方是对输入进行乘2，即左移1位</p>
<p>然后再</p>
<p>进行跟进，发现3函数进行了异或：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">int64 __fastcall <span class="title">sub_40156C</span><span class="params">(_DWORD *a1, <span class="keyword">unsigned</span> <span class="keyword">int</span> *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = *a2;</span><br><span class="line">  *a1 ^= result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但这个异或的值好像并没有给数组，然后我在存入input后面的地址处发现了逐渐出现的数组</p>
<p><img src="/2022/02/15/hgame-week4/image-20220222162432881.png"></p>
<p>后来我又在后面的地址发现了数组。。。。。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0x0000005E</span>, <span class="number">0x00000046</span>, <span class="number">0x00000061</span>, <span class="number">0x00000043</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000053</span>, <span class="number">0x00000049</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000051</span>, <span class="number">0x0000005E</span>, <span class="number">0x00000036</span>, <span class="number">0x00000037</span>, <span class="number">0x00000029</span>, <span class="number">0x00000041</span>, <span class="number">0x00000063</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000064</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000015</span>, <span class="number">0x00000018</span>, <span class="number">0x0000005B</span>, <span class="number">0x0000003E</span>, <span class="number">0x00000022</span>, <span class="number">0x00000050</span>, <span class="number">0x00000046</span>, <span class="number">0x0000005E</span>, <span class="number">0x00000035</span>, <span class="number">0x0000004E</span>, <span class="number">0x00000043</span>, <span class="number">0x00000023</span>, <span class="number">0x00000060</span>, <span class="number">0x0000003B</span>]<span class="comment">//异或的数组</span></span><br></pre></td></tr></table></figure>

<p>再调试下去，将32位调试完成后，又进行13 —&gt; 18 —&gt; 10 —&gt; 18 —&gt; 18 —&gt; 18 —&gt; 8 —&gt; 19 —&gt; 15 —&gt;</p>
<p>这个是对比，那么对比的数据在哪呢，对比的数据就在上面异或数据下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0x0000008E</span>, <span class="number">0x00000088</span>, <span class="number">0x000000A3</span>, <span class="number">0x00000099</span>, <span class="number">0x000000C4</span>, <span class="number">0x000000A5</span>, <span class="number">0x000000C3</span>, <span class="number">0x000000DD</span>, <span class="number">0x00000019</span>, <span class="number">0x000000EC</span>, <span class="number">0x0000006C</span>, <span class="number">0x0000009B</span>, <span class="number">0x000000F3</span>, <span class="number">0x0000001B</span>, <span class="number">0x0000008B</span>, <span class="number">0x0000005B</span>, <span class="number">0x0000003E</span>, <span class="number">0x0000009B</span>, <span class="number">0x000000F1</span>, <span class="number">0x00000086</span>, <span class="number">0x000000F3</span>, <span class="number">0x000000F4</span>, <span class="number">0x000000A4</span>, <span class="number">0x000000F8</span>, <span class="number">0x000000F8</span>, <span class="number">0x00000098</span>, <span class="number">0x000000AB</span>, <span class="number">0x00000086</span>, <span class="number">0x00000089</span>, <span class="number">0x00000061</span>, <span class="number">0x00000022</span>, <span class="number">0x000000C1</span>]<span class="comment">//最后对比数据</span></span><br></pre></td></tr></table></figure>

<p>那么很容易写出脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xor = [<span class="number">0x0000005E</span>, <span class="number">0x00000046</span>, <span class="number">0x00000061</span>, <span class="number">0x00000043</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000053</span>, <span class="number">0x00000049</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000051</span>, <span class="number">0x0000005E</span>, <span class="number">0x00000036</span>, <span class="number">0x00000037</span>, <span class="number">0x00000029</span>, <span class="number">0x00000041</span>, <span class="number">0x00000063</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000064</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000015</span>, <span class="number">0x00000018</span>, <span class="number">0x0000005B</span>, <span class="number">0x0000003E</span>, <span class="number">0x00000022</span>, <span class="number">0x00000050</span>, <span class="number">0x00000046</span>, <span class="number">0x0000005E</span>, <span class="number">0x00000035</span>, <span class="number">0x0000004E</span>, <span class="number">0x00000043</span>, <span class="number">0x00000023</span>, <span class="number">0x00000060</span>, <span class="number">0x0000003B</span>]</span><br><span class="line">data = [<span class="number">0x0000008E</span>, <span class="number">0x00000088</span>, <span class="number">0x000000A3</span>, <span class="number">0x00000099</span>, <span class="number">0x000000C4</span>, <span class="number">0x000000A5</span>, <span class="number">0x000000C3</span>, <span class="number">0x000000DD</span>, <span class="number">0x00000019</span>, <span class="number">0x000000EC</span>, <span class="number">0x0000006C</span>, <span class="number">0x0000009B</span>, <span class="number">0x000000F3</span>, <span class="number">0x0000001B</span>, <span class="number">0x0000008B</span>, <span class="number">0x0000005B</span>, <span class="number">0x0000003E</span>, <span class="number">0x0000009B</span>, <span class="number">0x000000F1</span>, <span class="number">0x00000086</span>, <span class="number">0x000000F3</span>, <span class="number">0x000000F4</span>, <span class="number">0x000000A4</span>, <span class="number">0x000000F8</span>, <span class="number">0x000000F8</span>, <span class="number">0x00000098</span>, <span class="number">0x000000AB</span>, <span class="number">0x00000086</span>, <span class="number">0x00000089</span>, <span class="number">0x00000061</span>, <span class="number">0x00000022</span>, <span class="number">0x000000C1</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">  flag += <span class="built_in">chr</span>((data[i]^xor[i])//<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>这个题刚开始很难，但越做越爽越清晰，出的太好了！</p>
<h3 id="server"><a href="#server" class="headerlink" title="server"></a>server</h3><p>这个题有点难度，我连rsa都没看出来，然后后面有两个异或还不好搞。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main_HttpHandleFunc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  __int64 v1; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v2; <span class="comment">// r14</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v3; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v7; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v8; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v9; <span class="comment">// rax</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+0h] [rbp-1368h]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+0h] [rbp-1368h]</span></span><br><span class="line">  __int64 v12; <span class="comment">// [rsp+0h] [rbp-1368h]</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+0h] [rbp-1368h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+0h] [rbp-1368h]</span></span><br><span class="line">  __int64 v15[<span class="number">154</span>]; <span class="comment">// [rsp+8h] [rbp-1360h] BYREF</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v16; <span class="comment">// [rsp+4D8h] [rbp-E90h]</span></span><br><span class="line">  __int64 v17; <span class="comment">// [rsp+4E0h] [rbp-E88h]</span></span><br><span class="line">  __int64 v18; <span class="comment">// [rsp+4E8h] [rbp-E80h]</span></span><br><span class="line">  __int64 v19; <span class="comment">// [rsp+4F0h] [rbp-E78h]</span></span><br><span class="line">  <span class="keyword">char</span> v20[<span class="number">1216</span>]; <span class="comment">// [rsp+4F8h] [rbp-E70h] BYREF</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+9B8h] [rbp-9B0h]</span></span><br><span class="line">  <span class="keyword">char</span> v22[<span class="number">1216</span>]; <span class="comment">// [rsp+9C0h] [rbp-9A8h] BYREF</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp+E80h] [rbp-4E8h]</span></span><br><span class="line">  <span class="keyword">char</span> v24[<span class="number">1216</span>]; <span class="comment">// [rsp+E88h] [rbp-4E0h] BYREF</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+1348h] [rbp-20h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+1350h] [rbp-18h]</span></span><br><span class="line">  __int64 v27; <span class="comment">// [rsp+1358h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">void</span> *retaddr; <span class="comment">// [rsp+1368h] [rbp+0h] BYREF</span></span><br><span class="line">  __int64 v30; <span class="comment">// [rsp+1370h] [rbp+8h]</span></span><br><span class="line">  __int64 v33; <span class="comment">// [rsp+1380h] [rbp+18h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( (<span class="keyword">unsigned</span> __int64)&amp;retaddr &lt; <span class="number">0x12E8</span> || (<span class="keyword">unsigned</span> __int64)&amp;v15[<span class="number">15</span>] &lt;= *(_QWORD *)(v2 + <span class="number">16</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v30 = v0;</span><br><span class="line">    v33 = v1;</span><br><span class="line">    runtime_morestack_noctxt();</span><br><span class="line">    v0 = v30;</span><br><span class="line">    v1 = v33;</span><br><span class="line">  &#125;</span><br><span class="line">  v27 = v1;</span><br><span class="line">  v10 = net_http___ptr_Request__ParseForm();</span><br><span class="line">  v3 = <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">  v15[<span class="number">2</span>] = net_http___ptr_Request__FormValue(v10, v15[<span class="number">0</span>], v15[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="string">&quot;flag&quot;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v16 = <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">    v25 = v4;</span><br><span class="line">    v5 = <span class="number">0LL</span>;</span><br><span class="line">    v6 = <span class="number">0LL</span>;</span><br><span class="line">    v7 = <span class="number">0LL</span>;</span><br><span class="line">    <span class="keyword">while</span> ( (__int64)v3 &gt; v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      v26 = v7;</span><br><span class="line">      v17 = v5;</span><br><span class="line">      v18 = v6;</span><br><span class="line">      v15[<span class="number">1</span>] = strconv_FormatInt(v11, v15[<span class="number">0</span>]);</span><br><span class="line">      v8 = v26;</span><br><span class="line">      v15[<span class="number">4</span>] = runtime_concatstring2(v13, v15[<span class="number">0</span>], v15[<span class="number">1</span>], v15[<span class="number">2</span>], v15[<span class="number">3</span>]);</span><br><span class="line">      v5 = v17 + <span class="number">1</span>;</span><br><span class="line">      v6 = v8;</span><br><span class="line">      v7 = v9;</span><br><span class="line">      v3 = v16;</span><br><span class="line">    &#125;</span><br><span class="line">    v19 = <span class="number">99LL</span>;</span><br><span class="line">    qmemcpy(v20, <span class="string">&quot;U&quot;</span>, <span class="keyword">sizeof</span>(v20));</span><br><span class="line">    main_encrypt();                 <span class="comment">//加密过程</span></span><br><span class="line">    v23 = v11;</span><br><span class="line">    qmemcpy(v24, v15, <span class="keyword">sizeof</span>(v24));</span><br><span class="line">    v21 = v19;</span><br><span class="line">    qmemcpy(v22, v20, <span class="keyword">sizeof</span>(v22));</span><br><span class="line">    runtime_memequal();</span><br><span class="line">    v15[<span class="number">2</span>] = runtime_convI2I(v11, v15[<span class="number">0</span>], v15[<span class="number">1</span>]);</span><br><span class="line">    v15[<span class="number">6</span>] = fmt_Fprintf(v14, v15[<span class="number">0</span>], v15[<span class="number">1</span>], v15[<span class="number">2</span>], v15[<span class="number">3</span>], v15[<span class="number">4</span>], v15[<span class="number">5</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v15[<span class="number">2</span>] = runtime_convI2I(v11, v15[<span class="number">0</span>], v15[<span class="number">1</span>]);</span><br><span class="line">    v15[<span class="number">6</span>] = fmt_Fprintf(v12, v15[<span class="number">0</span>], v15[<span class="number">1</span>], v15[<span class="number">2</span>], v15[<span class="number">3</span>], v15[<span class="number">4</span>], v15[<span class="number">5</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们进入这个加密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">int64 __usercall main_encrypt@&lt;rax&gt;(__int64 a1, __int64 a2)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v3; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v4; <span class="comment">// r14</span></span><br><span class="line">  __int128 v5; <span class="comment">// xmm15</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  __int64 v8; <span class="comment">// rax</span></span><br><span class="line">  __int64 v9; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v11; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v12; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v13; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v14; <span class="comment">// rax</span></span><br><span class="line">  __int64 v15; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v16; <span class="comment">// r8</span></span><br><span class="line">  __int64 i; <span class="comment">// rax</span></span><br><span class="line">  __int64 v18; <span class="comment">// rdx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v20; <span class="comment">// [rsp-28h] [rbp-5F0h]</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp-28h] [rbp-5F0h]</span></span><br><span class="line">  __int64 v22; <span class="comment">// [rsp-28h] [rbp-5F0h]</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp-28h] [rbp-5F0h]</span></span><br><span class="line">  __int64 v24; <span class="comment">// [rsp-20h] [rbp-5E8h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp-20h] [rbp-5E8h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp-20h] [rbp-5E8h]</span></span><br><span class="line">  __int64 v27; <span class="comment">// [rsp-18h] [rbp-5E0h]</span></span><br><span class="line">  __int64 v28; <span class="comment">// [rsp+20h] [rbp-5A8h]</span></span><br><span class="line">  <span class="keyword">char</span> v29[<span class="number">1216</span>]; <span class="comment">// [rsp+28h] [rbp-5A0h] BYREF</span></span><br><span class="line">  __int64 v30; <span class="comment">// [rsp+4E8h] [rbp-E0h]</span></span><br><span class="line">  __int64 v31; <span class="comment">// [rsp+4F0h] [rbp-D8h]</span></span><br><span class="line">  __int64 v32; <span class="comment">// [rsp+4F8h] [rbp-D0h]</span></span><br><span class="line">  <span class="keyword">char</span> v33; <span class="comment">// [rsp+500h] [rbp-C8h]</span></span><br><span class="line">  __int64 v34; <span class="comment">// [rsp+508h] [rbp-C0h]</span></span><br><span class="line">  __int128 v35; <span class="comment">// [rsp+510h] [rbp-B8h]</span></span><br><span class="line">  <span class="keyword">char</span> v36; <span class="comment">// [rsp+520h] [rbp-A8h]</span></span><br><span class="line">  __int64 v37; <span class="comment">// [rsp+528h] [rbp-A0h]</span></span><br><span class="line">  __int128 v38; <span class="comment">// [rsp+530h] [rbp-98h]</span></span><br><span class="line">  <span class="keyword">char</span> v39; <span class="comment">// [rsp+540h] [rbp-88h]</span></span><br><span class="line">  __int64 v40; <span class="comment">// [rsp+548h] [rbp-80h]</span></span><br><span class="line">  __int128 v41; <span class="comment">// [rsp+550h] [rbp-78h]</span></span><br><span class="line">  <span class="keyword">char</span> v42; <span class="comment">// [rsp+560h] [rbp-68h]</span></span><br><span class="line">  __int64 v43; <span class="comment">// [rsp+568h] [rbp-60h]</span></span><br><span class="line">  __int128 v44; <span class="comment">// [rsp+570h] [rbp-58h]</span></span><br><span class="line">  <span class="keyword">char</span> v45; <span class="comment">// [rsp+580h] [rbp-48h]</span></span><br><span class="line">  __int64 v46; <span class="comment">// [rsp+588h] [rbp-40h]</span></span><br><span class="line">  __int128 v47; <span class="comment">// [rsp+590h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">char</span> v48; <span class="comment">// [rsp+5A0h] [rbp-28h]</span></span><br><span class="line">  __int64 v49; <span class="comment">// [rsp+5A8h] [rbp-20h]</span></span><br><span class="line">  __int128 v50; <span class="comment">// [rsp+5B0h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( (<span class="keyword">unsigned</span> __int64)&amp;v29[<span class="number">48</span>] &lt;= *(_QWORD *)(v4 + <span class="number">16</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    STACK[<span class="number">0xA98</span>] = v2;</span><br><span class="line">    STACK[<span class="number">0xAA0</span>] = v3;</span><br><span class="line">    runtime_morestack_noctxt();</span><br><span class="line">    v2 = STACK[<span class="number">0xA98</span>];</span><br><span class="line">    v3 = STACK[<span class="number">0xAA0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  STACK[<span class="number">0xAA0</span>] = v3;</span><br><span class="line">  STACK[<span class="number">0xA98</span>] = v2;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;a2, <span class="number">0</span>, <span class="number">0x4C0</span>uLL);</span><br><span class="line">  v48 = <span class="number">0</span>;</span><br><span class="line">  v49 = <span class="number">0LL</span>;</span><br><span class="line">  v50 = v5;</span><br><span class="line">  math_big___ptr_Int__SetString();</span><br><span class="line">  v30 = v6;</span><br><span class="line">  v45 = <span class="number">0</span>;</span><br><span class="line">  v46 = <span class="number">0LL</span>;</span><br><span class="line">  v47 = v5;</span><br><span class="line">  v20 = math_big___ptr_Int__SetString();</span><br><span class="line">  v42 = <span class="number">0</span>;</span><br><span class="line">  v43 = <span class="number">0LL</span>;</span><br><span class="line">  v44 = v5;</span><br><span class="line">  v24 = math_big___ptr_Int__Mul(v20);</span><br><span class="line">  v31 = v7;</span><br><span class="line">  v39 = <span class="number">0</span>;</span><br><span class="line">  v40 = <span class="number">0LL</span>;</span><br><span class="line">  v41 = v5;</span><br><span class="line">  math_big___ptr_Int__SetString();</span><br><span class="line">  v32 = v8;</span><br><span class="line">  v36 = <span class="number">0</span>;</span><br><span class="line">  v37 = <span class="number">0LL</span>;</span><br><span class="line">  v38 = v5;</span><br><span class="line">  v21 = math_big___ptr_Int__SetString();</span><br><span class="line">  v33 = <span class="number">0</span>;</span><br><span class="line">  v34 = <span class="number">0LL</span>;</span><br><span class="line">  v35 = v5;</span><br><span class="line">  v27 = math_big___ptr_Int__Exp(v21, v24);</span><br><span class="line">  <span class="keyword">if</span> ( v9 )</span><br><span class="line">  &#123;</span><br><span class="line">    math_big_nat_itoa(v22, v25, v27);</span><br><span class="line">    v10 = v12;</span><br><span class="line">    runtime_slicebytetostring(v23, v26, v27);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">5LL</span>;</span><br><span class="line">    v11 = <span class="string">&quot;&lt;nil&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v28 = <span class="number">0LL</span>;</span><br><span class="line">  v13 = v11;</span><br><span class="line">  <span class="built_in">memset</span>(v29, <span class="number">0</span>, <span class="keyword">sizeof</span>(v29));</span><br><span class="line">  v14 = <span class="number">0LL</span>;</span><br><span class="line">  v15 = <span class="number">102LL</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v14 &lt; <span class="number">153</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v14 &gt;= v10 )</span><br><span class="line">      runtime_panicIndex();</span><br><span class="line">    v16 = (<span class="keyword">unsigned</span> __int8)v13[v14];</span><br><span class="line">    *(_QWORD *)&amp;v29[<span class="number">8</span> * v14++ - <span class="number">8</span>] = v16 ^ v15;</span><br><span class="line">    v15 = v16;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; <span class="number">153</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v18 = *(_QWORD *)&amp;v29[<span class="number">8</span> * i - <span class="number">8</span>];</span><br><span class="line">    *(_QWORD *)&amp;v29[<span class="number">8</span> * i - <span class="number">8</span>] = v18 ^ v15;</span><br><span class="line">    v15 = v18;</span><br><span class="line">  &#125;</span><br><span class="line">  result = v28;</span><br><span class="line">  qmemcpy(&amp;a2, v29, <span class="number">0x4C0</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们现在知道了p，q，e，那么我们只需要知道密文即可，这道题的密文缺了最后一位，因为我们无法得知最后一位异或的值，所以才用爆破的方法，我找了两位师傅写的，我认为写的非常好</p>
<p><img src="/2022/02/15/hgame-week4/image-20220222201015975.png"></p>
<p>舍去不能转换成可见字符的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="comment"># res 相当于 round_2</span></span><br><span class="line">res=[<span class="number">0x63</span>,<span class="number">0x55</span>,<span class="number">0x4</span>,<span class="number">0x3</span>,<span class="number">0x5</span>,<span class="number">0x5</span>,<span class="number">0x5</span>,<span class="number">0x3</span>,<span class="number">0x7</span>,<span class="number">0x7</span>,<span class="number">0x2</span>,<span class="number">0x8</span>,<span class="number">0x8</span>,<span class="number">0xb</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0xa</span>,<span class="number">0x4</span>,<span class="number">0x2</span>,<span class="number">0xd</span>,<span class="number">0x8</span>,<span class="number">0x9</span>,<span class="number">0xc</span>,<span class="number">0x9</span>,<span class="number">0x4</span>,<span class="number">0xd</span>,<span class="number">0x8</span>,<span class="number">0x0</span>,<span class="number">0xe</span>,<span class="number">0x0</span>,<span class="number">0xf</span>,<span class="number">0xd</span>,<span class="number">0xe</span>,<span class="number">0xa</span>,<span class="number">0x2</span>,<span class="number">0x2</span>,<span class="number">0x1</span>,<span class="number">0x7</span>,<span class="number">0x3</span>,<span class="number">0x5</span>,<span class="number">0x6</span>,<span class="number">0x4</span>,<span class="number">0x6</span>,<span class="number">0x7</span>,<span class="number">0x6</span>,<span class="number">0x2</span>,<span class="number">0x2</span>,<span class="number">0x5</span>,<span class="number">0x3</span>,<span class="number">0x3</span>,<span class="number">0x9</span>,<span class="number">0x6</span>,<span class="number">0x0</span>,<span class="number">0xb</span>,<span class="number">0xd</span>,<span class="number">0xb</span>,<span class="number">0x0</span>,<span class="number">0x2</span>,<span class="number">0x3</span>,<span class="number">0x8</span>,<span class="number">0x3</span>,<span class="number">0xb</span>,<span class="number">0x7</span>,<span class="number">0x1</span>,<span class="number">0xb</span>,<span class="number">0x5</span>,<span class="number">0xe</span>,<span class="number">0x5</span>,<span class="number">0x0</span>,<span class="number">0xa</span>,<span class="number">0xe</span>,<span class="number">0xf</span>,<span class="number">0xd</span>,<span class="number">0x7</span>,<span class="number">0xd</span>,<span class="number">0x7</span>,<span class="number">0xe</span>,<span class="number">0x1</span>,<span class="number">0xf</span>,<span class="number">0x1</span>,<span class="number">0xb</span>,<span class="number">0x5</span>,<span class="number">0x6</span>,<span class="number">0x2</span>,<span class="number">0xc</span>,<span class="number">0x6</span>,<span class="number">0xa</span>,<span class="number">0x4</span>,<span class="number">0x1</span>,<span class="number">0x7</span>,<span class="number">0x4</span>,<span class="number">0x2</span>,<span class="number">0x6</span>,<span class="number">0x3</span>,<span class="number">0x6</span>,<span class="number">0xc</span>,<span class="number">0x5</span>,<span class="number">0xc</span>,<span class="number">0x3</span>,<span class="number">0xc</span>,<span class="number">0x6</span>,<span class="number">0x0</span>,<span class="number">0x4</span>,<span class="number">0xf</span>,<span class="number">0x2</span>,<span class="number">0xe</span>,<span class="number">0x7</span>,<span class="number">0x0</span>,<span class="number">0xe</span>,<span class="number">0xe</span>,<span class="number">0xc</span>,<span class="number">0x4</span>,<span class="number">0x3</span>,<span class="number">0x4</span>,<span class="number">0x2</span>,<span class="number">0x0</span>,<span class="number">0x0</span>,<span class="number">0x2</span>,<span class="number">0x6</span>,<span class="number">0x2</span>,<span class="number">0x3</span>,<span class="number">0x6</span>,<span class="number">0x4</span>,<span class="number">0x4</span>,<span class="number">0x4</span>,<span class="number">0x7</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x3</span>,<span class="number">0x9</span>,<span class="number">0x2</span>,<span class="number">0xc</span>,<span class="number">0x8</span>,<span class="number">0x1</span>,<span class="number">0xc</span>,<span class="number">0x3</span>,<span class="number">0xc</span>,<span class="number">0x2</span>,<span class="number">0x0</span>,<span class="number">0x3</span>,<span class="number">0xe</span>,<span class="number">0x3</span>,<span class="number">0xe</span>,<span class="number">0xc</span>,<span class="number">0x9</span>,<span class="number">0x1</span>,<span class="number">0x7</span>,<span class="number">0xf</span>,<span class="number">0x5</span>,<span class="number">0x7</span>,<span class="number">0x2</span>,<span class="number">0x2</span>,<span class="number">0x4</span>]</span><br><span class="line">p=<span class="number">92582184765240663364795767694262273105045150785272129481762171937885924776597</span></span><br><span class="line">q=<span class="number">107310528658039985708896636559112400334262005367649176746429531274300859498993</span></span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">950501</span></span><br><span class="line">phin=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phin)</span><br><span class="line"><span class="comment"># i 相当于 cipher[len(cipher)-1]，爆破的目标</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x30</span>,<span class="number">0x3a</span>):</span><br><span class="line">  tmp1=[res[<span class="number">0</span>]^i] <span class="comment"># tmp1 相当于 round_1</span></span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(res)):</span><br><span class="line">    tmp1.append(res[j]^tmp1[j-<span class="number">1</span>])</span><br><span class="line">  tmp2=[tmp1[<span class="number">0</span>]^<span class="number">102</span>]<span class="comment"># tmp2 相当于 cipher</span></span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(tmp1)):</span><br><span class="line">    tmp2.append(tmp1[j]^tmp2[j-<span class="number">1</span>])</span><br><span class="line">  wrong=<span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> m <span class="keyword">in</span> tmp2: <span class="comment"># cipher 中每个元素都必须是十进制数字字符</span></span><br><span class="line">    <span class="keyword">if</span> m&lt;<span class="number">0x30</span> <span class="keyword">or</span> m&gt;<span class="number">0x39</span>:</span><br><span class="line">      wrong=<span class="number">1</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">if</span> wrong:</span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line">  <span class="keyword">if</span> i==tmp2[<span class="built_in">len</span>(tmp2)-<span class="number">1</span>]:<span class="comment"># 验证爆破的目标和还原出来的cipher[len(cipher)-1]是否相同</span></span><br><span class="line">    cipher=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> tmp2:</span><br><span class="line">      cipher+=<span class="built_in">chr</span>(k)</span><br><span class="line">    cipher_num=<span class="built_in">int</span>(cipher)</span><br><span class="line">    m=gmpy2.powmod(cipher_num,d,n)<span class="comment"># RSA解密</span></span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># hgame&#123;g0_and_g0_http_5erv3r_nb&#125;</span></span><br></pre></td></tr></table></figure>

<p>P1umH0师傅属实牛。go语言的逆向现在ida已经足够强大到可以搞定，没必要再用那些软件了。</p>
<h3 id="hardasm"><a href="#hardasm" class="headerlink" title="hardasm"></a>hardasm</h3><p>属实太难了，我参考了P1umH0师傅的解答，我学到了很多东西，这个7000行的代码审计真的离谱。</p>
<p><img src="/2022/02/15/hgame-week4/image-20220222202721197.png"></p>
<p>从此看出flag长度为32，</p>
<p><img src="/2022/02/15/hgame-week4/image-20220222203600401.png"></p>
<p>其实从上图我们或许能猜到，这个验证是对每一位进行的，输入后直接对比，对比完就跳转，我们输入hgame{aaaaaaaaaaaaaaaaaaaaaaaaaaaa}，然后进入[rsp+70h+var_50]中发现似乎是正确的地方会返回0FFh，我们跟进jz这个条件</p>
<p><img src="/2022/02/15/hgame-week4/image-20220222203545269.png"></p>
<p><img src="/2022/02/15/hgame-week4/image-20220222204237742.png"></p>
<p>很显然对的就success，错的就error，error是通过rcx寄存器进行储存，下面一个函数是通过调用call printf实现打印正确或者错误，我们完全可以使用patch的方法，将printf打印的结果变成[rsp+70h+var_50]上的数据。</p>
<p>如何改呢：</p>
<p><img src="/2022/02/15/hgame-week4/image-20220223173148339.png"></p>
<p>首先用ida自带的assembled，改不了，这里面缺少很多汇编，我下了个keypatch还是不行，不知道什么问题，然后手撸字节码，</p>
<p><img src="/2022/02/15/hgame-week4/image-20220223173426366.png"></p>
<p>接下来我们要做的就是将可视字符串进行尝试，看对应位置是哪个ascii，通过0xff来进行判断！</p>
<p>那么现在我有两种方法，一个是手动试，另一种是写代码自动化,subprocess是再父进程里开子进程，将我们修改过的hardasm.exe作为子进程，代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line">real_flag=<span class="string">&quot;hgame&#123;&quot;</span><span class="comment">#绝对正确的前6个字符</span></span><br><span class="line">cur_index=<span class="number">6</span><span class="comment">#当前爆破的位置</span></span><br><span class="line"><span class="keyword">while</span> cur_index&lt;<span class="number">32</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):<span class="comment">#当前爆破的位置上的字符</span></span><br><span class="line">        real_flag_arr = [<span class="number">0</span>] * <span class="number">32</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(real_flag)):<span class="comment">#正确的先复制一下</span></span><br><span class="line">            real_flag_arr[j]=<span class="built_in">ord</span>(real_flag[j])</span><br><span class="line">        real_flag_arr[<span class="built_in">len</span>(real_flag_arr)-<span class="number">1</span>]=<span class="built_in">ord</span>(<span class="string">&quot;&#125;&quot;</span>)<span class="comment">#最后一个字符&quot;&#125;&quot;固定</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(real_flag_arr)-<span class="number">2</span>,cur_index,-<span class="number">1</span>):<span class="comment">#除了当前爆破的位置，其他位置上都设置为32</span></span><br><span class="line">            real_flag_arr[j]=<span class="number">32</span></span><br><span class="line">        real_flag_arr[cur_index]=i<span class="comment">#设置当前爆破的位置上的字符</span></span><br><span class="line">        real_flag_arr_s=<span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> real_flag_arr)<span class="comment">#输入到程序中的字符串</span></span><br><span class="line">        p = subprocess.Popen([<span class="string">&quot;C:\\Users\\86159\\Documents\\Tencent Files\\506611735\\FileRecv\\Hgame2022\\week4\\hardasm.exe&quot;</span>], stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)</span><br><span class="line">        p.stdin.write(real_flag_arr_s.encode())</span><br><span class="line">        p.stdin.close()</span><br><span class="line">        out = p.stdout.read()</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(out)&gt;cur_index:<span class="comment">#判断程序打印出的0xFF的个数是否增加，增加则说明当前爆破的位置上的字符设置的是正确的</span></span><br><span class="line">            real_flag+=<span class="built_in">chr</span>(i)</span><br><span class="line">            cur_index+=<span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(real_flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># hgame&#123;r</span></span><br><span class="line"><span class="comment"># hgame&#123;ri</span></span><br><span class="line"><span class="comment"># hgame&#123;rig</span></span><br><span class="line"><span class="comment"># hgame&#123;righ</span></span><br><span class="line"><span class="comment"># hgame&#123;right</span></span><br><span class="line"><span class="comment"># hgame&#123;right_</span></span><br><span class="line"><span class="comment"># hgame&#123;right_y</span></span><br><span class="line"><span class="comment"># hgame&#123;right_yo</span></span><br><span class="line"><span class="comment"># hgame&#123;right_you</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_a</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_as</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_i</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_is</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_is_</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_is_g</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_is_go</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_is_goo</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_is_good</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_is_good!</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_is_good!!</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_is_good!!&#125;</span></span><br><span class="line"><span class="comment"># hgame&#123;right_your_asm_is_good!!&#125; </span></span><br></pre></td></tr></table></figure>

<p>总结来说，学到了很多，需要学的还有很多！加油吧！</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="摆烂"><a href="#摆烂" class="headerlink" title="摆烂"></a>摆烂</h3><p>先binwalk，发现里面有图片</p>
<p><img src="/2022/02/15/hgame-week4/image-20220223195526891.png"></p>
<p>提取出来</p>
<p><img src="/2022/02/15/hgame-week4/image-20220223195612850.png"></p>
<p>用01editor查看，发现里面有<code>acTL</code>、<code>fcTL</code>和<code>fdTL</code>数据块，便知道这张图片为 APNG 格式，即 PNG 动图</p>
<p>我们用</p>
<p> <a target="_blank" rel="noopener" href="https://products.aspose.app/imaging/zh-hans/image-view">https://products.aspose.app/imaging/zh-hans/image-view</a> 在线分离帧</p>
<p>找到两张图片，猜测是盲水印</p>
<p><img src="/2022/02/15/hgame-week4/image-20220223195751572.png"></p>
<p>记住bwm是py2，要用下一个软件，flag中发现密码：4C*9wfg976</p>
<p><img src="/2022/02/15/hgame-week4/image-20220223195824418.png"></p>
<p>密码输入压缩包内，有二维码</p>
<p><img src="/2022/02/15/hgame-week4/image-20220223195937870.png"></p>
<p>拼一下</p>
<p><img src="/2022/02/15/hgame-week4/image-20220223195957820.png"></p>
<p>得到一串汉字：</p>
<p>在这种困难的抉择下，本人思来想去‌‌‌‌‍‬‬‌，寝食难安。 既然如此‌‌‌‌‍‬‍﻿， 亚伯拉罕·林肯在不经意间这样说过，你活了多少岁不算什么‌‌‌‌‍‬‌‍，‌‌‌‌‍‬﻿‍重要的是你是如何度过这些岁月的。‌‌‌‌‍‬‍‍这启发了我，‌‌‌‌‍﻿‬﻿ CTF‌‌‌‌‌﻿‌‍好难，到底应该如何实现。‌‌‌‌‍‍﻿﻿‌‌‌‌‍‍‍﻿ ‌‌‌‌‌﻿‍‌‌‌‌‌‍‬﻿‬总结的来说‌‌‌‌‍‍‍‌‌‌‌‌‍‍﻿﻿， ‌‌‌‌‍‍‍‌‌‌‌‌‌﻿‌‌‌‌‌‌‍‍﻿﻿‌‌‌‌‍﻿‌‌我们都知道‌‌‌‌‌﻿‌‍‌‌‌‌‍‌‌‍，只要有意义‌‌‌‌‍﻿‬‍，‌‌‌‌‍‍﻿﻿那么就必须慎重考虑‌‌‌‌‍﻿‌‬。‌‌‌‌‌﻿‌‌‌‌‌‌‍‍‍‌‌‌‌‌‍﻿‍‌ 我认为， 每个人都不得不面对这些问题‌‌‌‌‍‬‍‍。‌‌‌‌‍‬﻿‬ 在面对这种问题时，‌‌‌‌‍﻿﻿‍ CTF好难，到底应该如何实现。</p>
<p>在vs中里面很不整齐，猜测为0宽字符加密，使用网站 <a target="_blank" rel="noopener" href="http://330k.github.io/misc_tools/unicode_steganography.html">http://330k.github.io/misc_tools/unicode_steganography.html</a> 解密</p>

      </section>

      
      
        <nav class="article-nav">
          
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2022/02/13/hgame-week3/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">hgame-week3</h2>
        </a>
      
      <div class="card-text--row">Older</div>
    </div>
  </article>
</div>
          
        </nav>
      

      <section class="page-message-container layout-padding">
        


  
  
    <div class="valine-container comments-container content-padding--primary soft-size--large soft-style--box">
      <div id="valine_thread" class="valine-thread"></div>
    </div>
    <script type="text/javascript" src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script type="text/javascript" src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <script type="text/javascript">
      new Valine({
        el: "#valine_thread",
        appId: "jonathanbest7",
        appKey: "Qxf15838819318",
        avatar: "mm",
        placeholder: "随便说点什么叭～",
        notify: true,
        visitor: true,
        pageSize: 10,
      });
    </script>
  

  
  


      </section>
    </div>
    <div class="widget-info">
      <section class="widget-author widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-body">
    
      <img src="https://s.gravatar.com/avatar/2d6b803eea37de0257620d5fabee7e64?s=200&amp;r=g&amp;d=retro" class="soft-size--round soft-style--box" alt="Jonathan">
    
    
      <h2>Jonathan</h2>
    
    
      <p>不以物喜，不以己悲</p>
    

    <div class="count-box">
      <div class="count-box--item">
        <svg class="icon icon-article" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M240.51564747 647.74217627h196.07203239c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806V165.10332731c0-33.18142087-30.16492806-60.32985613-60.32985612-60.32985611H245.04038668C225.43318342 104.7734712 210.35071939 119.85593522 210.35071939 139.46313845V617.57724821c0 16.59071043 13.57421762 30.16492806 30.16492808 30.16492806z m663.62841731-452.47392089v482.63884894c0 33.18142087-27.14843525 60.32985613-60.32985612 60.32985613H180.18579134c-33.18142087 0-60.32985613-27.14843525-60.32985612-60.32985613V195.26825538c-49.77213131 0-90.49478418 40.72265287-90.49478417 90.49478417v452.4739209c0 49.77213131 40.72265287 90.49478418 90.49478417 90.49478417h286.56681657c16.59071043 0 30.16492806 13.57421762 30.16492807 30.16492807s13.57421762 30.16492806 30.16492805 30.16492806h90.49478418c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806s13.57421762-30.16492806 30.16492807-30.16492807h286.56681657c49.77213131 0 90.49478418-40.72265287 90.49478417-90.49478417V285.76303955c0-49.77213131-40.72265287-90.49478418-90.49478417-90.49478417zM587.41232014 647.74217627h191.54729318c19.60720323 0 34.68966726-15.08246403 34.68966729-34.68966727V134.93839925c0-16.59071043-13.57421762-30.16492806-30.16492808-30.16492805H617.57724821c-30.16492806 0-60.32985613 27.14843525-60.32985612 60.32985611v452.4739209c0 16.59071043 13.57421762 30.16492806 30.16492805 30.16492806z" fill="currentColor"></path>
</svg>
        <span>28</span>
      </div>
      <div class="count-box--item">
        <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
        0
      </div>
      <div class="count-box--item">
        <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
        0
      </div>
    </div>
  </div>
</section>

      

      
<section class="widet-notice widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-notice" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M512 945.02305225v28.15620663a24.27259221 24.27259221 0 0 1-24.27259221 24.27259335H394.0352a48.54518557 48.54518557 0 0 1-41.74885888-23.78714112l-110.68302222-184.47170332a132.04290333 132.04290333 0 0 1-17.47626667-48.54518557h118.4502511a200.97706667 200.97706667 0 0 1 76.21594113 14.56355556l20.38897777 133.49925888a48.54518557 48.54518557 0 0 0 36.40888888 27.67075555l16.01991111 2.91271112a24.27259221 24.27259221 0 0 1 20.38897778 25.72894889zM997.45185223 463.45481443a194.18074112 194.18074112 0 0 1-38.8361489 116.50844445 24.75804445 24.75804445 0 0 1-36.4088889 0l-34.95253333-34.95253333a24.27259221 24.27259221 0 0 1-2.91271111-30.58346667 97.09036999 97.09036999 0 0 0 0-106.79940665 24.27259221 24.27259221 0 0 1 2.91271111-30.58346666l34.95253333-34.95253334a24.75804445 24.75804445 0 0 1 18.93262223-7.28177777 26.2144 26.2144 0 0 1 17.47626667 9.70903665A194.18074112 194.18074112 0 0 1 997.45185223 463.45481443z m-194.18074112-388.36148111v776.72296335a48.54518557 48.54518557 0 0 1-48.54518556 48.54518443h-28.64165888a48.54518557 48.54518557 0 0 1-33.98163001-14.07810332l-145.63555556-143.20829668A291.27111111 291.27111111 0 0 0 342.57730333 657.63555556H172.18370333a145.63555556 145.63555556 0 0 1-145.63555556-145.63555556v-97.09036999a145.63555556 145.63555556 0 0 1 145.63555556-145.63555556h170.3936a291.27111111 291.27111111 0 0 0 206.31703779-85.43952668l145.63555555-143.20829554a48.54518557 48.54518557 0 0 1 33.98162888-14.07810446H754.72592555a48.54518557 48.54518557 0 0 1 48.54518556 48.54518555z" fill="currentColor"></path>
</svg>
    <span>NOTICE</span>
  </div>
  <div class="widget-body">
    <p>QQ:506611735</p>
  </div>
</section>


      <section class="widget-categorys widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
    <span>CATEGORYS</span>
  </div>
  <div class="widget-body">
    <ul class="categorys-list">
      
    </ul>
  </div>
</section>

      <section class="widget-tags widget-item  layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
    <span>TAGS</span>
  </div>
  <div class="widget-body">
    <div class="tags-cloud">
      
    </div>
  </div>
</section>
    </div>
  </article>
</div>

    <!-- footer container -->
<footer id="footer" class="footer">
  <div class="footer-container">
    
    <div class="social-icons">
      
        
      
        
          <a href="https://www.zhihu.com/people/bang-ji-1" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg t="1587373160860" class="icon icon-zhihu" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M544.949 561.422s0-71.387-34.779-75.050c-34.779-3.663-142.775 0-142.775 0v-219.654h161.078s-1.83-73.219-32.949-73.219h-261.755l43.93-117.148s-65.897 3.663-89.692 45.761-98.844 252.604-98.844 252.604 25.627 10.983 67.726-20.134c42.101-31.116 56.743-86.033 56.743-86.033l76.879-3.663 1.83 223.316s-133.621-1.83-161.078 0c-27.457 1.83-42.101 75.050-42.101 75.050h203.182s-18.307 124.47-69.557 214.164c-53.085 89.692-151.929 161.078-151.929 161.078s71.387 29.287 140.947-10.983c69.557-42.101 120.811-223.316 120.811-223.316l162.912 203.182s14.643-97.013-1.83-124.47c-18.307-27.457-113.49-137.283-113.49-137.283l-42.101 36.607 29.287-120.811h177.552zM587.050 188.010l-1.83 660.793h65.897l23.795 82.37 115.321-82.37h162.912v-660.793h-366.091zM879.92 775.584h-76.879l-97.013 75.050-21.965-75.050h-20.134v-512.527h215.991v512.527z"></path>
</svg>
          </a>
        
      
        
      
        
          <a href="https://github.com/jonathanbest7" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64.6 512c0 195.6 125.4 361.9 300.1 422.9 23.5 5.9 19.9-10.8 19.9-22.2v-77.6c-135.8 15.9-141.3-74-150.5-89-18.5-31.5-61.9-39.5-49-54.5 31-15.9 62.5 4 98.9 58 26.4 39.1 77.9 32.5 104.1 26 5.7-23.5 17.9-44.5 34.7-60.9-140.7-25.2-199.4-111.1-199.4-213.3 0-49.5 16.4-95.1 48.4-131.8-20.4-60.6 1.9-112.4 4.9-120.1 58.2-5.2 118.5 41.6 123.3 45.3 33.1-8.9 70.8-13.7 112.9-13.7 42.4 0 80.3 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.4-43.9 2.9 7.7 24.7 58.3 5.5 118.1 32.5 36.8 49 82.8 49 132.4 0 102.3-59 188.3-200.2 213.2 23.5 23.3 38.1 55.5 38.1 91.1v112.7c0.8 9 0 17.9 15.1 17.9C832.7 877 960.4 709.4 960.4 512.1c0-247.5-200.6-447.9-447.9-447.9C265 64.1 64.6 264.5 64.6 512z"></path>
</svg>
          </a>
        
      
        
      
    </div>
     
    <p>&copy; 2022 <a href="/" target="_blank">Jonathan</a></p>

    

    <p>Powered by <a href="https://hexo.io" target="_blank" rel="noopener noreferrer">Hexo</a> Theme - <a href="https://github.com/miiiku/flex-block" target="_blank" rel="noopener noreferrer author">flex-block</a></p>

    <p>
      <a href="javascript:;" id="theme-light">🌞 浅色</a>
      <a href="javascript:;" id="theme-dark">🌛 深色</a>
      <a href="javascript:;" id="theme-auto">🤖️ 自动</a>
    </p>
  </div>
</footer>
  </div>

  <div class="back-to-top-fixed soft-size--round soft-style--box">
    <svg class="icon icon-back-to-top" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <path d="M725.333333 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8l-213.333333-213.333333c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l213.333333 213.333333c17.066667 17.066667 17.066667 42.666667 0 59.733333C746.666667 422.4 738.133333 426.666667 725.333333 426.666667z"></path>
      <path d="M298.666667 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l213.333333-213.333333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-213.333333 213.333333C320 422.4 311.466667 426.666667 298.666667 426.666667z"></path>
      <path d="M512 896c-25.6 0-42.666667-17.066667-42.666667-42.666667L469.333333 170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667l0 682.666667C554.666667 878.933333 537.6 896 512 896z"></path>
    </svg>
  </div>

  
  <!-- aplayer -->


<!-- dplayer -->




  


  


  




<script src="/js/script.js"></script>


  
  <!-- 尾部用户自定义相关内容 -->
</body>
</html>
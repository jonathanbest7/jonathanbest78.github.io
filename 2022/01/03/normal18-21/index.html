<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color" content="#3367D6"/>
  <link rel="apple-touch-icon" href="/icons-192.png">
  <link rel="manifest" href="/manifest.json">
  
  <meta name="generator" content="Hexo 5.4.0">

  

  

  
    <meta name="author" content="Jonathan">
  

  

  

  <title>Jonathan的小窝</title>

  

  
    <link rel="shortcut icon" href="/bitbug_favicon.ico">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@1.1.3/index.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs@9.16.2/styles/pojoaque.css">
  

  
<link rel="stylesheet" href="/css/style.css">

</head>
<body>
  <div class="root-container">
    
<!-- header container -->
<header class="header-container post">
  
    <div class="post-image" style="background-image: url(https://qiniu.sukoshi.xyz/src/images/68686407_p0.jpg)"></div>
  

  <!-- navbar -->
<nav class="navbar">
  <div class="navbar-content">
    <!-- logo -->
    <div class="navbar-logo">
      <a href="/">
        
          Jonathan的小窝
        
      </a>
    </div>
    <!-- link -->
    <div class="navbar-link">
      <div class="navbar-btn">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <ul class="navbar-list">
        
          <li class="navbar-list-item"><a href="/">首页</a></li>
        
          <li class="navbar-list-item"><a href="/links">友链</a></li>
        
          <li class="navbar-list-item"><a href="/about">关于</a></li>
        
          <li class="navbar-list-item"><a href="/tags">标签</a></li>
        
          <li class="navbar-list-item"><a href="/categories">分类</a></li>
        
      </ul>
    </div>
  </div>
</nav>

  
  

  
  

  
  

  
  

  
  
    <div class="header-content">
      <div class="post-text layout-block">
        <div class="layout-margin">
          <h1 class="title-wrap"></h1>
          <h2 class="title-sub-wrap">
            <strong>Jonathan</strong>
            <span>发布于</span>
            <time  class="article-date" datetime="2022-01-03T04:02:31.000Z" itemprop="datePublished">2022-01-03</time>
          </h2>
          <ul class="wrap-list dark">
  
</ul>
          <ul class="wrap-list dark">
  
</ul>
        </div>
      </div>
    </div>
  

  
  
  
</header>

    <!-- 文章 -->

<!-- 文章内容 -->
<div class="body-container">
  <article class="content-container layout-block post-container">
    <div class="article-info">
      
      
      
      
      <section class="article-entry markdown-body layout-margin content-padding--large soft-size--large soft-style--box">
        <h1 id="normal18-21"><a href="#normal18-21" class="headerlink" title="normal18-21"></a>normal18-21</h1><h2 id="normal18"><a href="#normal18" class="headerlink" title="normal18"></a>normal18</h2><p>这个题看着很难。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">int</span> __usercall wmain@&lt;eax&gt;(<span class="hljs-keyword">int</span> a1@&lt;ebx&gt;)<br>&#123;<br>  FILE *v1; <span class="hljs-comment">// eax</span><br>  FILE *v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">char</span> v4; <span class="hljs-comment">// [esp+3h] [ebp-405h]</span><br>  <span class="hljs-keyword">char</span> v5[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [esp+4h] [ebp-404h] BYREF</span><br>  <span class="hljs-keyword">char</span> Format[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [esp+104h] [ebp-304h] BYREF</span><br>  <span class="hljs-keyword">char</span> v7[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [esp+204h] [ebp-204h] BYREF</span><br>  <span class="hljs-keyword">char</span> v8[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [esp+304h] [ebp-104h] BYREF</span><br><br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Come one! Crack Me~~~\n&quot;</span>);<br>  <span class="hljs-built_in">memset</span>(v8, <span class="hljs-number">0</span>, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(v8));<br>  <span class="hljs-built_in">memset</span>(v7, <span class="hljs-number">0</span>, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(v7));<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;user(6-16 letters or numbers):&quot;</span>);<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, v8);<br>        v1 = (FILE *)<span class="hljs-built_in">sub_4024BE</span>();<br>        <span class="hljs-built_in">fflush</span>(v1);<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( !<span class="hljs-built_in">sub_401000</span>(v8) );<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;password(6-16 letters or numbers):&quot;</span>);<br>      <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, v7);<br>      v2 = (FILE *)<span class="hljs-built_in">sub_4024BE</span>();<br>      <span class="hljs-built_in">fflush</span>(v2);<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( !<span class="hljs-built_in">sub_401000</span>(v7) );<br>    <span class="hljs-built_in">sub_401090</span>(v8);<br>    <span class="hljs-built_in">memset</span>(Format, <span class="hljs-number">0</span>, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(Format));<br>    <span class="hljs-built_in">memset</span>(v5, <span class="hljs-number">0</span>, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(v5));<br>    v4 = ((<span class="hljs-built_in"><span class="hljs-keyword">int</span></span> (__cdecl *)(<span class="hljs-keyword">char</span> *, <span class="hljs-keyword">char</span> *))loc_4011A0)(Format, v5);<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">sub_401830</span>(a1, (<span class="hljs-keyword">int</span>)v8, v7) )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v4 )<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(v5);<br>  &#125;<br>  <span class="hljs-built_in">printf</span>(Format);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>先输入账号，账号已给出welcomebeijing，再输入密码。首先能看出来这个是个死循环，如果想跳出去，只能是让</p>
<p> sub_401830函数为1，我们进入跟踪一下。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">bool</span> __usercall sub_401830@&lt;al&gt;(<span class="hljs-keyword">int</span> a1@&lt;ebx&gt;, <span class="hljs-keyword">int</span> a2, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *a3)<br>&#123;<br>  <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// [esp+18h] [ebp-22Ch]</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// [esp+1Ch] [ebp-228h]</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// [esp+28h] [ebp-21Ch]</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// [esp+30h] [ebp-214h]</span><br>  <span class="hljs-keyword">char</span> v8; <span class="hljs-comment">// [esp+36h] [ebp-20Eh]</span><br>  <span class="hljs-keyword">char</span> v9; <span class="hljs-comment">// [esp+37h] [ebp-20Dh]</span><br>  <span class="hljs-keyword">char</span> v10; <span class="hljs-comment">// [esp+38h] [ebp-20Ch]</span><br>  <span class="hljs-keyword">unsigned</span> __int8 v11; <span class="hljs-comment">// [esp+39h] [ebp-20Bh]</span><br>  <span class="hljs-keyword">unsigned</span> __int8 v12; <span class="hljs-comment">// [esp+3Ah] [ebp-20Ah]</span><br>  <span class="hljs-keyword">char</span> v13; <span class="hljs-comment">// [esp+3Bh] [ebp-209h]</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v14; <span class="hljs-comment">// [esp+3Ch] [ebp-208h] BYREF</span><br>  <span class="hljs-keyword">char</span> v15; <span class="hljs-comment">// [esp+40h] [ebp-204h] BYREF</span><br>  <span class="hljs-keyword">char</span> v16[<span class="hljs-number">255</span>]; <span class="hljs-comment">// [esp+41h] [ebp-203h] BYREF</span><br>  <span class="hljs-keyword">char</span> v17[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [esp+140h] [ebp-104h] BYREF</span><br><br>  v5 = <span class="hljs-number">0</span>;<br>  v6 = <span class="hljs-number">0</span>;<br>  v12 = <span class="hljs-number">0</span>;<br>  v11 = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">memset</span>(v17, <span class="hljs-number">0</span>, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(v17));<br>  v15 = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">memset</span>(v16, <span class="hljs-number">0</span>, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(v16));<br>  v10 = <span class="hljs-number">0</span>;<br>  v7 = <span class="hljs-number">0</span>;<br>  v4 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> ( v7 &lt; <span class="hljs-built_in">strlen</span>(a3) )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">isdigit</span>(a3[v7]) )<br>    &#123;<br>      v9 = a3[v7] - <span class="hljs-number">48</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">isxdigit</span>(a3[v7]) )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( *((_DWORD *)<span class="hljs-built_in">NtCurrentPeb</span>()-&gt;ProcessHeap + <span class="hljs-number">3</span>) != <span class="hljs-number">2</span> )<span class="hljs-comment">// 反调试</span><br>        a3[v7] = <span class="hljs-number">34</span>;<br>      v9 = (a3[v7] | <span class="hljs-number">0x20</span>) - <span class="hljs-number">87</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v9 = ((a3[v7] | <span class="hljs-number">0x20</span>) - <span class="hljs-number">97</span>) % <span class="hljs-number">6</span> + <span class="hljs-number">10</span>;<br>    &#125;<br>    __rdtsc();<br>    __rdtsc();<br>    v10 = v9 + <span class="hljs-number">16</span> * v10;    <span class="hljs-comment">//以上的意思是把输入的密码（要求是十六进制字符）从hex_string转换位内存中的bytes，代表v16为密码</span><br>    <span class="hljs-keyword">if</span> ( !((<span class="hljs-keyword">int</span>)(v7 + <span class="hljs-number">1</span>) % <span class="hljs-number">2</span>) )<br>    &#123;<br>      v16[v4++ - <span class="hljs-number">1</span>] = v10;<br>      a1 = v4;<br>      v10 = <span class="hljs-number">0</span>;<br>    &#125;<br>    ++v7;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v6 &lt; <span class="hljs-number">8</span> )<br>  &#123;<br>    v11 += byte_416050[++v12];<br>    v13 = byte_416050[v12];<br>    v8 = byte_416050[v11];<br>    byte_416050[v11] = v13;<br>    byte_416050[v12] = v8;<br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-built_in">NtCurrentPeb</span>()-&gt;NtGlobalFlag &amp; <span class="hljs-number">0x70</span>) != <span class="hljs-number">0</span> )<span class="hljs-comment">// 反调试</span><br>      v13 = v11 + v12;<br>    v17[v6] = byte_416050[(<span class="hljs-keyword">unsigned</span> __int8)(v8 + v13)] ^ v16[v5 - <span class="hljs-number">1</span>];     <span class="hljs-comment">//只需找到byte_416050，就可推得密码</span><br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> __int8)*(_DWORD *)&amp;<span class="hljs-built_in">NtCurrentPeb</span>()-&gt;BeingDebugged )<span class="hljs-comment">// 反调试</span><br>    &#123;<br>      v11 = <span class="hljs-number">-83</span>;<br>      v12 = <span class="hljs-number">43</span>;<br>    &#125;<br>    <span class="hljs-built_in">sub_401710</span>((<span class="hljs-keyword">int</span>)v17, (<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *)a2, v6++);<br>    v5 = v6;<br>    <span class="hljs-keyword">if</span> ( v6 &gt;= (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(&amp;v16[<span class="hljs-built_in">strlen</span>(&amp;v15)] - v16) )<br>      v5 = <span class="hljs-number">0</span>;<br>  &#125;<br>  v14 = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">sub_401470</span>(a1, v17, &amp;v14);<br>  <span class="hljs-keyword">return</span> v14 == <span class="hljs-number">43924</span>;                          <span class="hljs-comment">// v14必须要等于43924</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>首先我们得让v14=43924，那么我们就要跟踪sub_401470函数，我们跟踪进去</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *__usercall sub_401470@&lt;eax&gt;(<span class="hljs-keyword">int</span> a1@&lt;ebx&gt;, _BYTE *a2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *a3)<br>&#123;<br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> _EAX; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">char</span> v5; <span class="hljs-comment">// al</span><br>  <span class="hljs-keyword">char</span> _AL; <span class="hljs-comment">// al</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *result; <span class="hljs-comment">// eax</span><br><br>  <span class="hljs-keyword">if</span> ( *a2 != <span class="hljs-string">&#x27;d&#x27;</span> )<br>    *a3 ^= <span class="hljs-number">3u</span>;<br>  <span class="hljs-keyword">else</span><br>    *a3 |= <span class="hljs-number">4u</span>;<br>  <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">1</span>] != <span class="hljs-string">&#x27;b&#x27;</span> )<br>  &#123;<br>    *a3 &amp;= <span class="hljs-number">0x61</span>u;<br>    _EAX = *a3;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    _EAX = (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)a3;<br>    *a3 |= <span class="hljs-number">0x14</span>u;<br>  &#125;<br>  __asm &#123; aam &#125;<br>  <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">2</span>] != <span class="hljs-string">&#x27;a&#x27;</span> )<br>    *a3 &amp;= <span class="hljs-number">0xA</span>u;<br>  <span class="hljs-keyword">else</span><br>    *a3 |= <span class="hljs-number">0x84</span>u;<br>  <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">3</span>] != <span class="hljs-string">&#x27;p&#x27;</span> )<br>    *a3 &gt;&gt;= <span class="hljs-number">7</span>;<br>  <span class="hljs-keyword">else</span><br>    *a3 |= <span class="hljs-number">0x114</span>u;<br>  <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">4</span>] != <span class="hljs-string">&#x27;p&#x27;</span> )<br>    *a3 *= <span class="hljs-number">2</span>;<br>  <span class="hljs-keyword">else</span><br>    *a3 |= <span class="hljs-number">0x380</span>u;<br>  <span class="hljs-keyword">if</span> ( *((_DWORD *)NtCurrentPeb()-&gt;ProcessHeap + <span class="hljs-number">3</span>) != <span class="hljs-number">2</span> )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">5</span>] != <span class="hljs-string">&#x27;f&#x27;</span> )<br>      *a3 |= <span class="hljs-number">0x21</span>u;<br>    <span class="hljs-keyword">else</span><br>      *a3 |= <span class="hljs-number">0x2DC</span>u;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">5</span>] != <span class="hljs-string">&#x27;s&#x27;</span> )<br>  &#123;<br>    v5 = (<span class="hljs-keyword">char</span>)a3;<br>    *a3 ^= <span class="hljs-number">0x1AD</span>u;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    *a3 |= <span class="hljs-number">0xA04</span>u;<br>    v5 = (<span class="hljs-keyword">char</span>)a3;<br>  &#125;<br>  _AL = v5 - (~(a1 &gt;&gt; <span class="hljs-number">5</span>) - <span class="hljs-number">1</span>);<br>  __asm &#123; daa &#125;<br>  <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">6</span>] != <span class="hljs-string">&#x27;e&#x27;</span> )<br>    *a3 |= <span class="hljs-number">0x4A</span>u;<br>  <span class="hljs-keyword">else</span><br>    *a3 |= <span class="hljs-number">0x2310</span>u;<br>  <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">7</span>] != <span class="hljs-string">&#x27;c&#x27;</span> )<br>  &#123;<br>    *a3 &amp;= <span class="hljs-number">0x3A3</span>u;<br>    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)*a3;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    result = a3;<br>    *a3 |= <span class="hljs-number">0x8A10</span>u;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这个函数中我们只需要判断a2[5]是等于‘ f ’还是‘ s ’。答案是s，所以我们得到了，a2也就是v17的字符串”dbappsec”，那么再看上个函数，跟v17有关的是个异或:  v17[v6] = byte_416050[(unsigned __int8)(v8 + v13)] ^ v16[v5 - 1]   ，由上面的分析，我们知道v16就是我们要找的，那么我们需要找到byte_416050，这个sbox里的字符串，我们用od来进行查找。</p>
<p><img src="/2022/01/03/normal18-21/image-20220103123359885.png"></p>
<p>在异或处下断点，观察ecx的值就是这个字符串，即[0x2a,0xd7,0x92,0xe9,0x53,0xe2,0xc4,0xcd]。</p>
<p>写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">code=[]<br>data1=[<span class="hljs-number">0x2a</span>,<span class="hljs-number">0xd7</span>,<span class="hljs-number">0x92</span>,<span class="hljs-number">0xe9</span>,<span class="hljs-number">0x53</span>,<span class="hljs-number">0xe2</span>,<span class="hljs-number">0xc4</span>,<span class="hljs-number">0xcd</span>]<br>data2=<span class="hljs-string">&quot;dbappsec&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data2)):<br>  code.append(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(data2[i])^data1[i]).replace(<span class="hljs-string">&quot;0x&quot;</span>,<span class="hljs-string">&quot;&quot;</span>))<br><span class="hljs-built_in">print</span>(code)<br></code></pre></td></tr></table></figure>

<p>得到：[‘4e’, ‘b5’, ‘f3’, ‘99’, ‘23’, ‘91’, ‘a1’, ‘ae’]，连起来即可。</p>
<p>还有一个问题啊，我在用od调试的时候并没有遇到wp上说的反调试，我在此补充一下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">if</span> ( *(_DWORD *)(__readfsdword(<span class="hljs-number">0x30</span>u) + <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0xFF</span> )<br></code></pre></td></tr></table></figure>

<p>我们的IsDebuggerPresent最后寻找的东西其实就是BeingDebugged字段。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( *(_DWORD *)(__readfsdword(<span class="hljs-number">0x30</span>u) + <span class="hljs-number">104</span>) &amp; <span class="hljs-number">0x70</span> )<br></code></pre></td></tr></table></figure>

<p>这个其实从PEB的结构中我们也不难看出也是反调试中经常出现的字段NtGlobalFlag</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( *(_DWORD *)(*(_DWORD *)(__readfsdword(<span class="hljs-number">0x30</span>u) + <span class="hljs-number">24</span>) + <span class="hljs-number">12</span>) != <span class="hljs-number">2</span> )<br></code></pre></td></tr></table></figure>

<p>这个也是经常用在反调试中的字段ProcessHeap。</p>
<p>如果在题目中出现__readfsdword(0x30u)意味着动调的时候参数会不对，最好用od来调试，若用ida调试，方法如下：</p>
<p>动调时手动修改代码，比如汇编下把jz改成jmp/jnz，可以改成jnz，机器码是74改成75。</p>
<h2 id="normal19"><a href="#normal19" class="headerlink" title="normal19"></a>normal19</h2><p>太摧毁我的自信心了，太难了，第一次遇见花指令</p>
<p><img src="/2022/01/03/normal18-21/image-20220103145232501.png"></p>
<p>这么一大坨东西，没加壳就是花指令了。</p>
<p>先用idapython去花</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">arr = [[<span class="hljs-number">0x4009A9</span>,<span class="hljs-number">0x4009C7</span>],[<span class="hljs-number">0x4009E0</span>,<span class="hljs-number">0x4009FE</span>],[<span class="hljs-number">0x400ACA</span>,<span class="hljs-number">0x400AE8</span>],[<span class="hljs-number">0x400B1A</span>,<span class="hljs-number">0x400B38</span>],[<span class="hljs-number">0x400B65</span>,<span class="hljs-number">0x400B92</span>],[<span class="hljs-number">0x400BEF</span>,<span class="hljs-number">0x400C00</span>]]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(arr)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(arr[i][<span class="hljs-number">0</span>],arr[i][<span class="hljs-number">1</span>]):<br>        ida_bytes.patch_byte(j,<span class="hljs-number">0x90</span>)<br></code></pre></td></tr></table></figure>

<p>去花后反编译就比较简单了</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">char</span> *v3; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// er12</span><br>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// edi</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">int</span> name_by_pid; <span class="hljs-comment">// ebp</span><br>  <span class="hljs-keyword">__pid_t</span> v8; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">__pid_t</span> v9; <span class="hljs-comment">// er13</span><br>  __int64 v10; <span class="hljs-comment">// rdx</span><br>  __int64 v11; <span class="hljs-comment">// rcx</span><br>  __int64 v12; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-keyword">int</span> v14; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-keyword">int</span> v15[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-4D8h] BYREF</span><br>  <span class="hljs-keyword">char</span> v16[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [rsp+8h] [rbp-4D0h] BYREF</span><br>  <span class="hljs-keyword">char</span> v17[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+Ch] [rbp-4CCh] BYREF</span><br>  <span class="hljs-keyword">char</span> v18[<span class="hljs-number">56</span>]; <span class="hljs-comment">// [rsp+14h] [rbp-4C4h] BYREF</span><br>  <span class="hljs-keyword">char</span> v19; <span class="hljs-comment">// [rsp+4Ch] [rbp-48Ch] BYREF</span><br>  <span class="hljs-keyword">int</span> v20[<span class="hljs-number">20</span>]; <span class="hljs-comment">// [rsp+50h] [rbp-488h]</span><br>  <span class="hljs-keyword">char</span> v21[<span class="hljs-number">1032</span>]; <span class="hljs-comment">// [rsp+A0h] [rbp-438h] BYREF</span><br>  <span class="hljs-keyword">unsigned</span> __int64 v22; <span class="hljs-comment">// [rsp+4A8h] [rbp-30h]</span><br><br>  v3 = (<span class="hljs-keyword">char</span> *)v15;<br>  v22 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  v4 = <span class="hljs-built_in">time</span>(<span class="hljs-number">0LL</span>);<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    v3 += <span class="hljs-number">4</span>;<br>    *((_DWORD *)v3 - <span class="hljs-number">1</span>) = _IO_getc(_bss_start);<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v3 != &amp;v19 );<br>  v20[<span class="hljs-number">0</span>] = <span class="hljs-number">83</span>;<br>  v20[<span class="hljs-number">1</span>] = <span class="hljs-number">64</span>;<br>  v20[<span class="hljs-number">2</span>] = <span class="hljs-number">121</span>;<br>  v20[<span class="hljs-number">3</span>] = <span class="hljs-number">82</span>;<br>  v20[<span class="hljs-number">4</span>] = <span class="hljs-number">116</span>;<br>  v20[<span class="hljs-number">5</span>] = <span class="hljs-number">102</span>;<br>  v20[<span class="hljs-number">6</span>] = <span class="hljs-number">84</span>;<br>  v20[<span class="hljs-number">7</span>] = <span class="hljs-number">108</span>;<br>  v20[<span class="hljs-number">8</span>] = <span class="hljs-number">48</span>;<br>  v20[<span class="hljs-number">9</span>] = <span class="hljs-number">43</span>;<br>  v20[<span class="hljs-number">10</span>] = <span class="hljs-number">97</span>;<br>  v20[<span class="hljs-number">11</span>] = <span class="hljs-number">103</span>;<br>  v20[<span class="hljs-number">12</span>] = <span class="hljs-number">45</span>;<br>  v20[<span class="hljs-number">13</span>] = <span class="hljs-number">76</span>;<br>  v20[<span class="hljs-number">14</span>] = <span class="hljs-number">95</span>;<br>  v20[<span class="hljs-number">15</span>] = <span class="hljs-number">51</span>;<br>  v20[<span class="hljs-number">16</span>] = <span class="hljs-number">77</span>;<br>  v20[<span class="hljs-number">17</span>] = <span class="hljs-number">125</span>;<br>  v20[<span class="hljs-number">18</span>] = <span class="hljs-number">123</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">ptrace</span>(PTRACE_TRACEME, <span class="hljs-number">0LL</span>, <span class="hljs-number">1LL</span>, <span class="hljs-number">0LL</span>) &lt; <span class="hljs-number">0</span> )<br>  &#123;<br>    v14 = <span class="hljs-number">10000000</span>;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      <span class="hljs-built_in">sleep</span>(<span class="hljs-number">1u</span>);<br>      --v14;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v14 );<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br>  &#125;<br>  v5 = <span class="hljs-built_in">time</span>(<span class="hljs-number">0LL</span>) - v4;<br>  <span class="hljs-keyword">if</span> ( v5 &gt; <span class="hljs-number">1</span> )<br>    <span class="hljs-keyword">goto</span> LABEL_16;<br>  <span class="hljs-built_in">func3</span>(v18, <span class="hljs-number">2LL</span>, <span class="hljs-number">7LL</span>, <span class="hljs-number">14LL</span>);<br>  <span class="hljs-built_in">func3</span>(v16, <span class="hljs-number">4LL</span>, <span class="hljs-number">6LL</span>, <span class="hljs-number">17LL</span>);<br>  <span class="hljs-built_in">func3</span>(&amp;v18[<span class="hljs-number">16</span>], <span class="hljs-number">3LL</span>, <span class="hljs-number">5LL</span>, <span class="hljs-number">10LL</span>);<br>  v6 = <span class="hljs-built_in">getppid</span>();<br>  name_by_pid = <span class="hljs-built_in">get_name_by_pid</span>(v6, v21);<br>  <span class="hljs-keyword">if</span> ( name_by_pid )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  <span class="hljs-built_in">func3</span>(v15, <span class="hljs-number">6LL</span>, <span class="hljs-number">9LL</span>, <span class="hljs-number">15LL</span>);<br>  <span class="hljs-built_in">func3</span>(&amp;v18[<span class="hljs-number">24</span>], <span class="hljs-number">3LL</span>, <span class="hljs-number">6LL</span>, <span class="hljs-number">8LL</span>);<br>  v5 = <span class="hljs-built_in">time</span>(<span class="hljs-number">0LL</span>) - v4;<br>  <span class="hljs-keyword">if</span> ( v5 &gt; <span class="hljs-number">2</span> )<br>LABEL_16:<br>    <span class="hljs-built_in">exit</span>(v5);<br>  <span class="hljs-built_in">func3</span>(v18, <span class="hljs-number">1LL</span>, <span class="hljs-number">5LL</span>, <span class="hljs-number">14LL</span>);<br>  v8 = <span class="hljs-built_in">getpid</span>();<br>  v9 = <span class="hljs-built_in">getsid</span>(v8);<br>  <span class="hljs-keyword">if</span> ( v9 != <span class="hljs-built_in">getppid</span>() )<br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;what are you doing?!&quot;</span>);<br>    v5 = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">goto</span> LABEL_16;<br>  &#125;<br>  <span class="hljs-built_in">func3</span>(v15, <span class="hljs-number">0LL</span>, <span class="hljs-number">2LL</span>, <span class="hljs-number">19LL</span>);<br>  <span class="hljs-built_in">func3</span>(v17, <span class="hljs-number">3LL</span>, <span class="hljs-number">5LL</span>, <span class="hljs-number">16LL</span>);<br>  <span class="hljs-built_in">func3</span>(&amp;v18[<span class="hljs-number">40</span>], <span class="hljs-number">1LL</span>, <span class="hljs-number">3LL</span>, <span class="hljs-number">4LL</span>);<br>  <span class="hljs-built_in">func3</span>(&amp;v18[<span class="hljs-number">12</span>], <span class="hljs-number">3LL</span>, <span class="hljs-number">6LL</span>, <span class="hljs-number">11LL</span>);<br>  <span class="hljs-built_in">func3</span>(v15, <span class="hljs-number">0LL</span>, <span class="hljs-number">7LL</span>, <span class="hljs-number">19LL</span>);<br>  <span class="hljs-built_in">func3</span>(v15, <span class="hljs-number">0LL</span>, v10, v11);<br>  <span class="hljs-built_in">func3</span>(&amp;v18[<span class="hljs-number">20</span>], <span class="hljs-number">0LL</span>, <span class="hljs-number">2LL</span>, <span class="hljs-number">9LL</span>);<br>  v5 = <span class="hljs-built_in">time</span>(<span class="hljs-number">0LL</span>) - v4;<br>  <span class="hljs-keyword">if</span> ( v5 &gt; <span class="hljs-number">3</span> )<br>    <span class="hljs-keyword">goto</span> LABEL_16;<br>  v12 = <span class="hljs-number">0LL</span>;<br>  <span class="hljs-built_in">func3</span>(&amp;v18[<span class="hljs-number">24</span>], <span class="hljs-number">1LL</span>, <span class="hljs-number">3LL</span>, <span class="hljs-number">8LL</span>);<br>  <span class="hljs-built_in">func3</span>(&amp;v18[<span class="hljs-number">44</span>], <span class="hljs-number">0LL</span>, <span class="hljs-number">2LL</span>, <span class="hljs-number">3LL</span>);<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v20[v12] != v15[v12] )<br>    &#123;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You failed&quot;</span>);<br>      v5 = v12;<br>      <span class="hljs-keyword">goto</span> LABEL_16;<br>    &#125;<br>    ++v12;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v12 != <span class="hljs-number">19</span> );<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;win&quot;</span>);<br>  <span class="hljs-keyword">return</span> name_by_pid;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>fun3很复杂所以可以猜测这个题跟前面的一道题很像，直接输进去数就行，然后观察变化即可。</p>
<p>我们发现很多goto ，会goto到exit，去除！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">arr = [[<span class="hljs-number">0x400972</span>,<span class="hljs-number">0x400978</span>], [<span class="hljs-number">0x400987</span>,<span class="hljs-number">0x40098D</span>],[<span class="hljs-number">0x400A2F</span>,<span class="hljs-number">0x400A35</span>],[<span class="hljs-number">0x400A77</span>,<span class="hljs-number">0x400A7D</span>],[<span class="hljs-number">0x400AAB</span>,<span class="hljs-number">0x400AB1</span>],[<span class="hljs-number">0x400BBC</span>,<span class="hljs-number">0x400BC2</span>]]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(arr)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(arr[i][<span class="hljs-number">0</span>],arr[i][<span class="hljs-number">1</span>]):<br>        ida_bytes.patch_byte(j,<span class="hljs-number">0x90</span>)<br></code></pre></td></tr></table></figure>

<p>大致就是将goto的首地址和下一行地址写进arr列表中，然后全部nop掉，找goto的汇编可以看旁边有指引的线。</p>
<p>接下来我们动调，发现不行，里面有很多_sleep等的反调试，我们将其nop掉。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">data1=<span class="hljs-string">&quot;0123456789abcdefghi&quot;</span><br>data2=<span class="hljs-string">&quot;8f6c90e1dg237abh5i4&quot;</span><br>t=<span class="hljs-string">&quot;S@yRtfTl0+ag-L_3M&#125;&#123;&quot;</span><br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(t)):<br>  flag+=t[data2.find(data1[i])]<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag&#123;My-StL_R0T@+3&#125;</span><br></code></pre></td></tr></table></figure>

<p>结束！</p>
<h2 id="normal20"><a href="#normal20" class="headerlink" title="normal20"></a>normal20</h2><p>又是一道z3题，这个题看起来非常简单，但是逆过来确实不好逆，所以用z3最好解决</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// esi</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// kr00_4</span><br>  <span class="hljs-keyword">char</span> v5; <span class="hljs-comment">// bl</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">char</span> *v7; <span class="hljs-comment">// edx</span><br>  <span class="hljs-keyword">char</span> v8; <span class="hljs-comment">// cl</span><br>  <span class="hljs-keyword">int</span> v9; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">char</span> v11[<span class="hljs-number">80</span>]; <span class="hljs-comment">// [esp+8h] [ebp-A4h] BYREF</span><br>  <span class="hljs-keyword">char</span> v12[<span class="hljs-number">80</span>]; <span class="hljs-comment">// [esp+58h] [ebp-54h] BYREF</span><br><br>  <span class="hljs-built_in">sub_401020</span>(<span class="hljs-string">&quot;Please input your flag: &quot;</span>);<br>  <span class="hljs-built_in">sub_401050</span>(<span class="hljs-string">&quot;%40s&quot;</span>, v12);<br>  <span class="hljs-built_in">memset</span>(v11, <span class="hljs-number">0</span>, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(v11));<br>  v3 = <span class="hljs-number">0</span>;<br>  v4 = <span class="hljs-built_in">strlen</span>(v12);<br>  <span class="hljs-keyword">if</span> ( v4 )<br>  &#123;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      v5 = v12[v3];<br>      <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; ++i )<br>      &#123;<br>        v7 = &amp;v11[i + v3];<br>        v8 = v5 ^ byte_41C658[i];<br>        *v7 += v8;<br>      &#125;<br>      ++v3;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v3 &lt; v4 );<br>  &#125;<br>  v9 = <span class="hljs-built_in">strcmp</span>(v11, aR);                         <span class="hljs-comment">// v9必须是1，也就是说v11就是aR</span><br>  <span class="hljs-keyword">if</span> ( v9 )<br>    v9 = v9 &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">-1</span> : <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">if</span> ( v9 )<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No, it isn&#x27;t.&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes, it is.&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>讲一下？的用法：&lt;表达式1&gt;?&lt;表达式2&gt;:&lt;表达式3&gt;<br>在运算中，首第一个表达式进行检验，如果为真，则返回表达式2的值;如果为假，则返回表达式3的值</p>
<p>直接给出z3脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span>*<br>s=Solver()<br>aR=[<span class="hljs-number">0x72</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x03</span>]<br>data=[<span class="hljs-number">0x21</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x7E</span>]<br>flag = [BitVec(<span class="hljs-string">&quot;flag%d&quot;</span> % i,<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x22</span>)]<br>v5=[<span class="hljs-number">0</span>]*<span class="hljs-number">0x41</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>  s.add(flag[i] &lt; <span class="hljs-number">127</span>)<br>  s.add(flag[i] &gt; <span class="hljs-number">32</span>)<br>v3=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x22</span>):<br>  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    v5[i+j] += flag[i] ^ data[j]<br>  v3 += <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(aR)):<br>  s.add(aR[t] == v5[t])<br><span class="hljs-keyword">if</span> s.check() == sat:<br>  m = s.model()<br>  res = []<br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x22</span>):<br>    res.append(<span class="hljs-built_in">chr</span>(m[flag[i]].as_long()))<br>    s=<span class="hljs-string">&#x27;&#x27;</span>.join(res)<br>  <span class="hljs-built_in">print</span>(s)<br><span class="hljs-keyword">else</span>:<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;nope&quot;</span>)  <br><span class="hljs-built_in">print</span>(v5)<br><span class="hljs-comment">#SYC&#123;4+mile+b3gin+with+sing1e+step&#125;</span><br></code></pre></td></tr></table></figure>

<p>看来是极客的题。。。</p>
<h2 id="normal21"><a href="#normal21" class="headerlink" title="normal21"></a>normal21</h2><p>这个题终极难，还是感觉自己写脚本能力太差，这个寒假要努力将自己编程能力提升上去。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  _DWORD *v4; <span class="hljs-comment">// [esp+1Ch] [ebp-A0h]</span><br>  _WORD v5[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [esp+20h] [ebp-9Ch] BYREF</span><br>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// [esp+28h] [ebp-94h]</span><br>  <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// [esp+2Ch] [ebp-90h]</span><br>  <span class="hljs-keyword">char</span> v8[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [esp+30h] [ebp-8Ch] BYREF</span><br>  <span class="hljs-keyword">char</span> v9[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [esp+50h] [ebp-6Ch] BYREF</span><br>  <span class="hljs-keyword">char</span> v10[<span class="hljs-number">76</span>]; <span class="hljs-comment">// [esp+70h] [ebp-4Ch] BYREF</span><br><br>  sub_402620();<br>  <span class="hljs-built_in">strcpy</span>((<span class="hljs-keyword">char</span> *)v5, <span class="hljs-string">&quot;qweee&quot;</span>);<br>  v5[<span class="hljs-number">3</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>  v6 = <span class="hljs-number">0</span>;<br>  v7 = <span class="hljs-number">0</span>;<br>  v4 = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x408</span>u);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Plz solve the puzzle:&quot;</span>);<br>  sub_40ED00(<span class="hljs-string">&quot;%32s&quot;</span>, v8);<br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> __int8)sub_401C70(v8)          <span class="hljs-comment">// flag的区间</span><br>    &amp;&amp; (sub_401B60(<br>          (<span class="hljs-keyword">int</span>)v9,<br>          v8),                                  <span class="hljs-comment">// 16进制字符转换成byte</span><br>        sub_401850(v4, (<span class="hljs-keyword">int</span>)v5, <span class="hljs-built_in">strlen</span>((<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *)v5)),<br>        sub_4018D0(v4, v9, <span class="hljs-number">8</span>),<br>        sub_401950(v9)) )<br>  &#123;<br>    sub_401BA0(v8, (<span class="hljs-keyword">int</span>)v10);<br>    sub_40ED20(<span class="hljs-string">&quot;Congrats!\n%s\n&quot;</span>, v10);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这个题主要有5个函数，我们逐一查看</p>
<p>函数一：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">sub_401C70</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *Str)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">char</span> *v2; <span class="hljs-comment">// edx</span><br><br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(Str) != <span class="hljs-number">16</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  v2 = Str;<br>  <span class="hljs-keyword">while</span> ( (<span class="hljs-keyword">unsigned</span> __int8)(*v2 - <span class="hljs-number">58</span>) &gt; <span class="hljs-number">0x26</span>u &amp;&amp; (<span class="hljs-keyword">unsigned</span> __int8)(*v2 - <span class="hljs-number">48</span>) &lt;= <span class="hljs-number">0x36</span>u )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( ++v2 == Str + <span class="hljs-number">16</span> )<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这个函数限定了str长度为16，那么能取那些字符呢？是用下面的while循环进行的判断。写出脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>  a=i<br>  <span class="hljs-keyword">if</span> (a-<span class="hljs-number">58</span>)&amp;<span class="hljs-number">0xff</span> &gt; <span class="hljs-number">0x26</span> <span class="hljs-keyword">and</span> (a-<span class="hljs-number">48</span>)&amp;<span class="hljs-number">0xff</span>  &lt;= <span class="hljs-number">0x36</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i))<br><span class="hljs-number">0</span><br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">3</span><br><span class="hljs-number">4</span><br><span class="hljs-number">5</span><br><span class="hljs-number">6</span><br><span class="hljs-number">7</span><br><span class="hljs-number">8</span><br><span class="hljs-number">9</span><br>a<br>b<br>c<br>d<br>e<br>f<br></code></pre></td></tr></table></figure>

<p>我们要注意在c语言中：范围是不同的，所以0-9也ok</p>
<h3 id="int"><a href="#int" class="headerlink" title="int"></a>int</h3><p>int8取值范围是-128 - 127<br>unsigned int8 0-255</p>
<p>Int16 意思是16位整数(16bit integer)，相当于short 占2个字节 -32768 ~ 32767</p>
<p>Int32 意思是32位整数(32bit integer), 相当于 int 占4个字节 -2147483648 ~ 2147483647</p>
<p>Int64 意思是64位整数(64bit interger), 相当于 long long 占8个字节 -9223372036854775808 ~ 9223372036854775807Byte 相当于byte(unsigned char) 0 ~ 255</p>
<p>WORD 等于 unsigned short 0 ~ 65535</p>
<p>接下来看第二个函数。</p>
<p>函数二：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">sub_401B60</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a1, _BYTE *a2)</span></span><br><span class="hljs-function"></span>&#123;<br>  _BYTE *i; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-keyword">int</span> result; <span class="hljs-comment">// eax</span><br>  _BYTE *v5; <span class="hljs-comment">// [esp+0h] [ebp-1Ch]</span><br>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// [esp+8h] [ebp-14h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = a2; *i; result = sub_40ED40(v5, <span class="hljs-string">&quot;%02X&quot;</span>, v6) )<span class="hljs-comment">// sprintf格式化输出</span><br>  &#123;<br>    v6 = a1;<br>    v5 = i;<br>    i += <span class="hljs-number">2</span>;<br>    ++a1;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这个函数无法理解，但从动态调试中可以猜测是将输入的16进制字符串转换为byte型数组，并用sprintf格式化输出。</p>
<p>这里补充一下sprintf的用法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sprintf``(s, ``&quot;%8d%8d&quot;``, 123, 4567); ``// 产生：&quot;  123  4567&quot;<br></code></pre></td></tr></table></figure>

<p>例如这个，很好的代表了其用法，第二个参数用来规定格式化的形式，第二个参数后面可以加多个参数，后面的参数都要按照第二个参数来规定。</p>
<p>第三个函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">sub_401850</span><span class="hljs-params">(_DWORD *a1, <span class="hljs-keyword">int</span> a2, <span class="hljs-keyword">int</span> a3)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// eax</span><br>  _DWORD *v4; <span class="hljs-comment">// edi</span><br>  <span class="hljs-keyword">int</span> *v5; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-keyword">int</span> result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">int</span> v8; <span class="hljs-comment">// esi</span><br>  <span class="hljs-keyword">char</span> v9; <span class="hljs-comment">// dl</span><br>  <span class="hljs-keyword">int</span> *v10; <span class="hljs-comment">// edx</span><br><br>  v3 = <span class="hljs-number">0</span>;<br>  v4 = a1 + <span class="hljs-number">2</span>;<br>  *a1 = <span class="hljs-number">0</span>;<br>  a1[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    v4[v3] = v3;<br>    ++v3;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v3 != <span class="hljs-number">256</span> );<br>  v5 = a1 + <span class="hljs-number">2</span>;<br>  v6 = <span class="hljs-number">0</span>;<br>  LOBYTE(result) = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    v8 = *v5;<br>    v9 = *(_BYTE *)(a2 + v6++) + *v5;<br>    result = (<span class="hljs-keyword">unsigned</span> __int8)(v9 + result);<br>    v10 = &amp;v4[result];<br>    *v5 = *v10;<br>    *v10 = v8;<br>    <span class="hljs-keyword">if</span> ( v6 &gt;= a3 )<br>      v6 = <span class="hljs-number">0</span>;<br>    ++v5;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v5 != a1 + <span class="hljs-number">258</span> );<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这个函数应该是凭借密钥的顺序，来改变自身，从而生成一个data盒。我们通过动态调试是能够找到data的。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">[<span class="hljs-number">0x00000071</span>, <span class="hljs-number">0x000000A2</span>, <span class="hljs-number">0x00000062</span>, <span class="hljs-number">0x00000031</span>, <span class="hljs-number">0x0000004D</span>, <span class="hljs-number">0x00000097</span>, <span class="hljs-number">0x00000014</span>, <span class="hljs-number">0x0000000D</span>, <span class="hljs-number">0x000000ED</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x000000D6</span>, <span class="hljs-number">0x000000FC</span>, <span class="hljs-number">0x000000F1</span>, <span class="hljs-number">0x0000003B</span>, <span class="hljs-number">0x0000003C</span>, <span class="hljs-number">0x00000033</span>, <span class="hljs-number">0x000000B5</span>, <span class="hljs-number">0x00000022</span>, <span class="hljs-number">0x00000012</span>, <span class="hljs-number">0x0000001A</span>, <span class="hljs-number">0x00000017</span>, <span class="hljs-number">0x0000001D</span>, <span class="hljs-number">0x00000098</span>, <span class="hljs-number">0x00000091</span>, <span class="hljs-number">0x00000006</span>, <span class="hljs-number">0x0000002A</span>, <span class="hljs-number">0x0000008B</span>, <span class="hljs-number">0x00000023</span>, <span class="hljs-number">0x000000E6</span>, <span class="hljs-number">0x00000055</span>, <span class="hljs-number">0x00000046</span>, <span class="hljs-number">0x0000003A</span>, <span class="hljs-number">0x00000065</span>, <span class="hljs-number">0x00000028</span>, <span class="hljs-number">0x00000030</span>, <span class="hljs-number">0x00000039</span>, <span class="hljs-number">0x000000D4</span>, <span class="hljs-number">0x0000000C</span>, <span class="hljs-number">0x00000001</span>, <span class="hljs-number">0x0000002D</span>, <span class="hljs-number">0x00000025</span>, <span class="hljs-number">0x00000010</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x0000008F</span>, <span class="hljs-number">0x0000006A</span>, <span class="hljs-number">0x0000003F</span>, <span class="hljs-number">0x00000044</span>, <span class="hljs-number">0x000000D8</span>, <span class="hljs-number">0x0000006D</span>, <span class="hljs-number">0x000000C5</span>, <span class="hljs-number">0x000000A6</span>, <span class="hljs-number">0x00000072</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x00000083</span>, <span class="hljs-number">0x00000040</span>, <span class="hljs-number">0x000000C6</span>, <span class="hljs-number">0x0000008E</span>, <span class="hljs-number">0x0000001F</span>, <span class="hljs-number">0x00000077</span>, <span class="hljs-number">0x00000061</span>, <span class="hljs-number">0x00000096</span>, <span class="hljs-number">0x0000004A</span>, <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x000000FE</span>, <span class="hljs-number">0x00000053</span>, <span class="hljs-number">0x0000005A</span>, <span class="hljs-number">0x000000A1</span>, <span class="hljs-number">0x000000DF</span>, <span class="hljs-number">0x000000B6</span>, <span class="hljs-number">0x00000067</span>, <span class="hljs-number">0x00000066</span>, <span class="hljs-number">0x0000005C</span>, <span class="hljs-number">0x00000057</span>, <span class="hljs-number">0x000000B8</span>, <span class="hljs-number">0x000000D3</span>, <span class="hljs-number">0x00000011</span>, <span class="hljs-number">0x00000052</span>, <span class="hljs-number">0x00000021</span>, <span class="hljs-number">0x000000CC</span>, <span class="hljs-number">0x00000056</span>, <span class="hljs-number">0x0000002E</span>, <span class="hljs-number">0x000000C2</span>, <span class="hljs-number">0x00000088</span>, <span class="hljs-number">0x000000AA</span>, <span class="hljs-number">0x000000F9</span>, <span class="hljs-number">0x00000020</span>, <span class="hljs-number">0x0000007A</span>, <span class="hljs-number">0x0000006F</span>, <span class="hljs-number">0x0000004E</span>, <span class="hljs-number">0x00000076</span>, <span class="hljs-number">0x000000E8</span>, <span class="hljs-number">0x000000C1</span>, <span class="hljs-number">0x000000D5</span>, <span class="hljs-number">0x000000BD</span>, <span class="hljs-number">0x000000CE</span>, <span class="hljs-number">0x0000009E</span>, <span class="hljs-number">0x00000038</span>, <span class="hljs-number">0x00000095</span>, <span class="hljs-number">0x00000050</span>, <span class="hljs-number">0x000000F2</span>, <span class="hljs-number">0x0000009F</span>, <span class="hljs-number">0x000000B2</span>, <span class="hljs-number">0x0000009A</span>, <span class="hljs-number">0x0000000B</span>, <span class="hljs-number">0x00000047</span>, <span class="hljs-number">0x00000016</span>, <span class="hljs-number">0x00000060</span>, <span class="hljs-number">0x000000BF</span>, <span class="hljs-number">0x000000FD</span>, <span class="hljs-number">0x00000092</span>, <span class="hljs-number">0x00000035</span>, <span class="hljs-number">0x00000089</span>, <span class="hljs-number">0x000000DA</span>, <span class="hljs-number">0x000000FF</span>, <span class="hljs-number">0x0000009B</span>, <span class="hljs-number">0x000000BA</span>, <span class="hljs-number">0x00000013</span>, <span class="hljs-number">0x000000AB</span>, <span class="hljs-number">0x000000F4</span>, <span class="hljs-number">0x00000079</span>, <span class="hljs-number">0x00000087</span>, <span class="hljs-number">0x000000AC</span>, <span class="hljs-number">0x0000008C</span>, <span class="hljs-number">0x00000073</span>, <span class="hljs-number">0x00000084</span>, <span class="hljs-number">0x000000B3</span>, <span class="hljs-number">0x0000000E</span>, <span class="hljs-number">0x000000C8</span>, <span class="hljs-number">0x00000026</span>, <span class="hljs-number">0x000000A5</span>, <span class="hljs-number">0x000000E7</span>, <span class="hljs-number">0x00000015</span>, <span class="hljs-number">0x000000E9</span>, <span class="hljs-number">0x000000C3</span>, <span class="hljs-number">0x00000069</span>, <span class="hljs-number">0x00000070</span>, <span class="hljs-number">0x000000E0</span>, <span class="hljs-number">0x00000068</span>, <span class="hljs-number">0x00000042</span>, <span class="hljs-number">0x00000081</span>, <span class="hljs-number">0x000000CD</span>, <span class="hljs-number">0x000000EB</span>, <span class="hljs-number">0x000000DE</span>, <span class="hljs-number">0x0000007D</span>, <span class="hljs-number">0x000000EF</span>, <span class="hljs-number">0x000000D0</span>, <span class="hljs-number">0x00000024</span>, <span class="hljs-number">0x00000000</span>, <span class="hljs-number">0x000000F0</span>, <span class="hljs-number">0x00000041</span>, <span class="hljs-number">0x000000A0</span>, <span class="hljs-number">0x000000EE</span>, <span class="hljs-number">0x00000005</span>, <span class="hljs-number">0x00000094</span>, <span class="hljs-number">0x00000085</span>, <span class="hljs-number">0x000000BB</span>, <span class="hljs-number">0x00000043</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x000000F7</span>, <span class="hljs-number">0x000000C0</span>, <span class="hljs-number">0x000000D1</span>, <span class="hljs-number">0x0000001B</span>, <span class="hljs-number">0x0000007F</span>, <span class="hljs-number">0x0000005B</span>, <span class="hljs-number">0x000000EC</span>, <span class="hljs-number">0x000000F6</span>, <span class="hljs-number">0x0000002B</span>, <span class="hljs-number">0x0000001E</span>, <span class="hljs-number">0x000000E2</span>, <span class="hljs-number">0x00000027</span>, <span class="hljs-number">0x000000FB</span>, <span class="hljs-number">0x00000078</span>, <span class="hljs-number">0x00000054</span>, <span class="hljs-number">0x00000058</span>, <span class="hljs-number">0x000000E4</span>, <span class="hljs-number">0x00000032</span>, <span class="hljs-number">0x000000DB</span>, <span class="hljs-number">0x000000B7</span>, <span class="hljs-number">0x000000C7</span>, <span class="hljs-number">0x00000090</span>, <span class="hljs-number">0x0000007C</span>, <span class="hljs-number">0x000000F8</span>, <span class="hljs-number">0x0000005D</span>, <span class="hljs-number">0x0000005F</span>, <span class="hljs-number">0x00000063</span>, <span class="hljs-number">0x000000BE</span>, <span class="hljs-number">0x0000002C</span>, <span class="hljs-number">0x0000000A</span>, <span class="hljs-number">0x000000DD</span>, <span class="hljs-number">0x0000009C</span>, <span class="hljs-number">0x00000075</span>, <span class="hljs-number">0x00000019</span>, <span class="hljs-number">0x000000C4</span>, <span class="hljs-number">0x000000A8</span>, <span class="hljs-number">0x00000086</span>, <span class="hljs-number">0x00000036</span>, <span class="hljs-number">0x000000BC</span>, <span class="hljs-number">0x0000008D</span>, <span class="hljs-number">0x000000D7</span>, <span class="hljs-number">0x0000007B</span>, <span class="hljs-number">0x000000B4</span>, <span class="hljs-number">0x0000005E</span>, <span class="hljs-number">0x0000003E</span>, <span class="hljs-number">0x000000A7</span>, <span class="hljs-number">0x000000B1</span>, <span class="hljs-number">0x000000E1</span>, <span class="hljs-number">0x00000059</span>, <span class="hljs-number">0x00000082</span>, <span class="hljs-number">0x000000B9</span>, <span class="hljs-number">0x000000AE</span>, <span class="hljs-number">0x000000D9</span>, <span class="hljs-number">0x0000007E</span>, <span class="hljs-number">0x000000AF</span>, <span class="hljs-number">0x000000CF</span>, <span class="hljs-number">0x0000009D</span>, <span class="hljs-number">0x000000F5</span>, <span class="hljs-number">0x000000FA</span>, <span class="hljs-number">0x00000048</span>, <span class="hljs-number">0x0000004F</span>, <span class="hljs-number">0x000000A9</span>, <span class="hljs-number">0x0000006C</span>, <span class="hljs-number">0x00000064</span>, <span class="hljs-number">0x0000006E</span>, <span class="hljs-number">0x00000049</span>, <span class="hljs-number">0x0000004B</span>, <span class="hljs-number">0x0000006B</span>, <span class="hljs-number">0x00000029</span>, <span class="hljs-number">0x00000045</span>, <span class="hljs-number">0x000000E5</span>, <span class="hljs-number">0x00000004</span>, <span class="hljs-number">0x000000A4</span>, <span class="hljs-number">0x0000004C</span>, <span class="hljs-number">0x00000034</span>, <span class="hljs-number">0x00000080</span>, <span class="hljs-number">0x000000D2</span>, <span class="hljs-number">0x0000003D</span>, <span class="hljs-number">0x000000E3</span>, <span class="hljs-number">0x00000099</span>, <span class="hljs-number">0x00000037</span>, <span class="hljs-number">0x000000DC</span>, <span class="hljs-number">0x00000093</span>, <span class="hljs-number">0x000000C9</span>, <span class="hljs-number">0x000000CA</span>, <span class="hljs-number">0x000000CB</span>, <span class="hljs-number">0x000000EA</span>, <span class="hljs-number">0x000000B0</span>, <span class="hljs-number">0x0000000F</span>, <span class="hljs-number">0x00000003</span>, <span class="hljs-number">0x0000008A</span>, <span class="hljs-number">0x000000F3</span>, <span class="hljs-number">0x00000051</span>, <span class="hljs-number">0x0000001C</span>, <span class="hljs-number">0x000000AD</span>, <span class="hljs-number">0x00000074</span>, <span class="hljs-number">0x00000018</span>, <span class="hljs-number">0x0000002F</span>]<br></code></pre></td></tr></table></figure>

<p>这个就是生成的data盒。</p>
<p>第四个函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function">DWORD *__cdecl <span class="hljs-title">sub_4018D0</span><span class="hljs-params">(_DWORD *a1, _BYTE *a2, <span class="hljs-keyword">int</span> a3)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// edx</span><br>  <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// ecx</span><br>  _DWORD *v5; <span class="hljs-comment">// esi</span><br>  _BYTE *v6; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// edi</span><br>  <span class="hljs-keyword">int</span> *v8; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">int</span> v9; <span class="hljs-comment">// edx</span><br>  <span class="hljs-keyword">int</span> v10; <span class="hljs-comment">// ebp</span><br>  _DWORD *result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">int</span> *v12; <span class="hljs-comment">// [esp+0h] [ebp-18h]</span><br><br>  v3 = *a1;<br>  v4 = a1[<span class="hljs-number">1</span>];<br>  v5 = a1 + <span class="hljs-number">2</span>;<br>  <span class="hljs-keyword">if</span> ( a3 &gt; <span class="hljs-number">0</span> )<br>  &#123;<br>    v6 = a2;<br>    v7 = *a1;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      v7 = (<span class="hljs-keyword">unsigned</span> __int8)(v7 + <span class="hljs-number">1</span>);<br>      v8 = &amp;v5[v7];<br>      v9 = *v8;<br>      v4 = (<span class="hljs-keyword">unsigned</span> __int8)(*v8 + v4);<br>      v12 = &amp;v5[v4];<br>      v10 = *v12;<br>      *v8 = *v12;<br>      *v12 = v9;<br>      *v6++ ^= v5[(<span class="hljs-keyword">unsigned</span> __int8)(v9 + v10)]; <span class="hljs-comment">// v6是输入的字符串，v5是生成的data</span><br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v6 != &amp;a2[a3] );<br>    v3 = v7;<br>  &#125;<br>  result = a1;<br>  *a1 = v3;<br>  a1[<span class="hljs-number">1</span>] = v4;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这个异或函数是最有用的，我们从中能看出很多东西，比如，v5是data盒，我们是根据v9+v10来从data中选择数据的。我们在这一行设断点，来查看生成的数据。发现分别为[0x7C,0xAB,0x2D,0x91,0x2F,0x98,0xED,0xA9]。也就是说我们输入的字符串和这个固定的字符串异或后产生了新的字符串，那么我们只要找到新的字符串。</p>
<p>第5个函数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> __cdecl <span class="hljs-title">sub_401950</span><span class="hljs-params">(_BYTE *a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  _BYTE *v1; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-keyword">bool</span> result; <span class="hljs-comment">// al</span><br><br>  v1 = a1;<br>  <span class="hljs-keyword">do</span><br>  &#123;<br>    <span class="hljs-built_in"><span class="hljs-keyword">switch</span></span> ( *v1 )                              <span class="hljs-comment">// v1是输入的字符串</span><br>    &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>        dword_40F028 &amp;= dword_40F038;<br>        dword_40F02C *= dword_40F028;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">if</span> ( !dword_40F02C )<br>          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        dword_40F028 /= dword_40F02C;<br>        dword_40F024 += dword_40F034;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        dword_40F030 ^= dword_40F034;<br>        dword_40F03C += dword_40F020;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        dword_40F03C -= dword_40F030;<br>        dword_40F030 &amp;= dword_40F024;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>        dword_40F034 *= dword_40F020;<br>        dword_40F02C -= dword_40F038;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>        dword_40F020 ^= dword_40F02C;<br>        dword_40F038 -= dword_40F03C;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:<br>        <span class="hljs-keyword">if</span> ( !dword_40F03C )<br>          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        dword_40F034 |= dword_40F024 / dword_40F03C;<br>        dword_40F024 /= dword_40F03C;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:<br>        dword_40F038 += dword_40F028;<br>        dword_40F034 |= dword_40F024;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>        dword_40F020 *= dword_40F02C;<br>        dword_40F030 -= dword_40F03C;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">9</span>:<br>        dword_40F028 += dword_40F034;<br>        dword_40F02C ^= dword_40F030;<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    ++v1;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( v1 != a1 + <span class="hljs-number">8</span> );<br>  result = (dword_40F038 == <span class="hljs-number">231</span>)<br><br>   + (dword_40F034 == <span class="hljs-number">14456</span>)<br>     ord_40F030 == <span class="hljs-number">14961</span>)<br>        + (dword_40F02C == <span class="hljs-number">-13264</span>)<br>          ord_40F028 == <span class="hljs-number">16</span>)<br>             + (dword_40F024 == <span class="hljs-number">104</span>)<br>               ord_40F020 == <span class="hljs-number">-951</span>) == <span class="hljs-number">7</span>;<br>                 <span class="hljs-keyword">if</span> ( dword_40F03C != <span class="hljs-number">-239</span> )<br>                   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>                 <span class="hljs-keyword">return</span> result;<br>               &#125;<br><br><br></code></pre></td></tr></table></figure>

<p>我们惊喜的发现，这个函数所做的操作正是对变换后的字符串的操作，所以我们只需要看这个函数就行，这个函数逆向是不可能的，所以采用爆破是最好的方法，但属实不会写脚本，就照着wp写了一遍。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdbool.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Check</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *str)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>  <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">long</span> a = <span class="hljs-number">99999999</span>;<br>  <span class="hljs-keyword">while</span>(i &lt;= a)&#123;<br>    <span class="hljs-keyword">char</span> str[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-built_in">sprintf</span>(str,<span class="hljs-string">&quot;%08d&quot;</span>,i);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Check</span>(str))&#123;<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;TRUE!!!!!:  %s&quot;</span>,str);<br>      <span class="hljs-keyword">goto</span> label;<br>      <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(i % <span class="hljs-number">1000</span> == <span class="hljs-number">0</span>)&#123;<br>      <span class="hljs-built_in">puts</span>(str);      <br>    &#125;<br>    i++;<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;falied\n&quot;</span>);<br>label:<br>  <span class="hljs-built_in">getchar</span>();<br>  <span class="hljs-built_in">getchar</span>();<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Check</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *str)</span></span>&#123;<br>  <span class="hljs-keyword">int</span> dword_40F000 = <span class="hljs-number">0xA</span>;<br>  <span class="hljs-keyword">int</span> dword_40F020 = <span class="hljs-number">0x8A</span>;<br>  <span class="hljs-keyword">int</span> dword_40F024 = <span class="hljs-number">0x1A1</span>;<br>  <span class="hljs-keyword">int</span> dword_40F028 = <span class="hljs-number">0x12A</span>；<br>  <span class="hljs-keyword">int</span> dword_40F02C = <span class="hljs-number">0x269</span>;<br>  <span class="hljs-keyword">int</span> dword_40F030 = <span class="hljs-number">0x209</span>;<br>  <span class="hljs-keyword">int</span> dword_40F034 = <span class="hljs-number">0x68</span>;<br>  <span class="hljs-keyword">int</span> dword_40F038 = <span class="hljs-number">0x39F</span>;<br>  <span class="hljs-keyword">int</span> dword_40F03C = <span class="hljs-number">0x2C8</span>;<br>  <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i &lt; <span class="hljs-number">8</span>;i++)&#123;<br>    <span class="hljs-built_in"><span class="hljs-keyword">switch</span></span> (str[i] - <span class="hljs-number">48</span>)<br>    &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>      dword_40F028 &amp;= dword_40F038;      <br>      dword_40F02C *= dword_40F028;<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>      <span class="hljs-keyword">if</span> ( !dword_40F02C )<br>        <span class="hljs-keyword">goto</span> LABEL_6;<br>      dword_40F028 /= dword_40F02C;<br>      dword_40F024 += dword_40F034;<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>      dword_40F030 ^= dword_40F034;<br>      dword_40F03C += dword_40F020;<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>      dword_40F03C -= dword_40F030;<br>      dword_40F030 &amp;= dword_40F024;   <br>      <span class="hljs-keyword">break</span>; <br>    <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>      dword_40F034 *= dword_40F020;<br>      dword_40F02C -= dword_40F038;<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>      dword_40F020 ^= dword_40F02C;<br>      dword_40F038 -= dword_40F03C;<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:<br>      <span class="hljs-keyword">if</span> ( !dword_40F03C )<br>        <span class="hljs-keyword">goto</span> LABEL_6;<br>      dword_40F034 |= dword_40F024 / dword_40F03C;<br>      dword_40F024 /= dword_40F03C;<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:<br>      dword_40F038 += dword_40F028;<br>      dword_40F034 |= dword_40F024;<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>      dword_40F020 *= dword_40F02C;<br>      dword_40F030 -= dword_40F03C;<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">9</span>:<br>      dword_40F028 += dword_40F034;<br>      dword_40F02C ^= dword_40F030;<br>    <span class="hljs-keyword">default</span>:<br>      <span class="hljs-keyword">break</span>;<br>    &#125;<br>  &#125;<br>    result = (((dword_40F038 == <span class="hljs-number">0xE7</span>)     <br>    + (dword_40F034 == <span class="hljs-number">0x3878</span>)<br>    + (dword_40F030 == <span class="hljs-number">0x3A71</span>)<br>    + (dword_40F02C == <span class="hljs-number">0xFFFFCC30</span>)<br>    + (dword_40F028 == <span class="hljs-number">0x10</span>)<br>    + (dword_40F024 == <span class="hljs-number">0x68</span>)<br>    + (dword_40F020 == <span class="hljs-number">0xFFFFFC49</span>)) == <span class="hljs-number">7</span>);<br>  <span class="hljs-keyword">if</span> ( dword_40F03C != <span class="hljs-number">0xFFFFFF11</span> )<br>    <span class="hljs-keyword">goto</span> LABEL_6;<br>  <span class="hljs-keyword">if</span>(result == <span class="hljs-number">1</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>  &#125;<br>LABEL_6:<br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><span class="hljs-comment">//得到爆破后的字符串61495072</span><br></code></pre></td></tr></table></figure>

<p>师傅写的很清楚明了，学习了！</p>
<p>我们接下来异或一下得到我们要输入的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x7C</span>,<span class="hljs-number">0xAB</span>,<span class="hljs-number">0x2D</span>,<span class="hljs-number">0x91</span>,<span class="hljs-number">0x2F</span>,<span class="hljs-number">0x98</span>,<span class="hljs-number">0xED</span>,<span class="hljs-number">0xA9</span>]<br>b=[<span class="hljs-number">0x06</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x02</span>]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>  flag+=<span class="hljs-string">&quot;%x&quot;</span>%(a[i]^b[i])   <span class="hljs-comment">#转化成16进制</span><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#7aaa29982a98eaab</span><br></code></pre></td></tr></table></figure>

<p>输入终端，得到flag</p>
<p>flag{5cb92582-66a8-e5b7-d3bf-3b99df8ac7f0}</p>

      </section>

      
      
        <nav class="article-nav">
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2022/01/04/normal22-25/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">normal22-25</h2>
        </a>
      
      <div class="card-text--row">Newer</div>
    </div>
  </article>
</div>
          
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2021/12/30/RSA-BASE64-AES/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">RSA-BASE64-AES</h2>
        </a>
      
      <div class="card-text--row">Older</div>
    </div>
  </article>
</div>
          
        </nav>
      

      <section class="page-message-container layout-padding">
        


  
  
    <div class="valine-container comments-container content-padding--primary soft-size--large soft-style--box">
      <div id="valine_thread" class="valine-thread"></div>
    </div>
    <script type="text/javascript" src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script type="text/javascript" src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <script type="text/javascript">
      new Valine({
        el: "#valine_thread",
        appId: "jonathanbest7",
        appKey: "Qxf15838819318",
        avatar: "mm",
        placeholder: "随便说点什么叭～",
        notify: true,
        visitor: true,
        pageSize: 10,
      });
    </script>
  

  
  


      </section>
    </div>
    <div class="widget-info">
      <section class="widget-author widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-body">
    
      <img src="https://s.gravatar.com/avatar/2d6b803eea37de0257620d5fabee7e64?s=200&amp;r=g&amp;d=retro" class="soft-size--round soft-style--box" alt="Jonathan">
    
    
      <h2>Jonathan</h2>
    
    
      <p>不以物喜，不以己悲</p>
    

    <div class="count-box">
      <div class="count-box--item">
        <svg class="icon icon-article" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M240.51564747 647.74217627h196.07203239c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806V165.10332731c0-33.18142087-30.16492806-60.32985613-60.32985612-60.32985611H245.04038668C225.43318342 104.7734712 210.35071939 119.85593522 210.35071939 139.46313845V617.57724821c0 16.59071043 13.57421762 30.16492806 30.16492808 30.16492806z m663.62841731-452.47392089v482.63884894c0 33.18142087-27.14843525 60.32985613-60.32985612 60.32985613H180.18579134c-33.18142087 0-60.32985613-27.14843525-60.32985612-60.32985613V195.26825538c-49.77213131 0-90.49478418 40.72265287-90.49478417 90.49478417v452.4739209c0 49.77213131 40.72265287 90.49478418 90.49478417 90.49478417h286.56681657c16.59071043 0 30.16492806 13.57421762 30.16492807 30.16492807s13.57421762 30.16492806 30.16492805 30.16492806h90.49478418c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806s13.57421762-30.16492806 30.16492807-30.16492807h286.56681657c49.77213131 0 90.49478418-40.72265287 90.49478417-90.49478417V285.76303955c0-49.77213131-40.72265287-90.49478418-90.49478417-90.49478417zM587.41232014 647.74217627h191.54729318c19.60720323 0 34.68966726-15.08246403 34.68966729-34.68966727V134.93839925c0-16.59071043-13.57421762-30.16492806-30.16492808-30.16492805H617.57724821c-30.16492806 0-60.32985613 27.14843525-60.32985612 60.32985611v452.4739209c0 16.59071043 13.57421762 30.16492806 30.16492805 30.16492806z" fill="currentColor"></path>
</svg>
        <span>45</span>
      </div>
      <div class="count-box--item">
        <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
        0
      </div>
      <div class="count-box--item">
        <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
        0
      </div>
    </div>
  </div>
</section>

      

      
<section class="widet-notice widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-notice" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M512 945.02305225v28.15620663a24.27259221 24.27259221 0 0 1-24.27259221 24.27259335H394.0352a48.54518557 48.54518557 0 0 1-41.74885888-23.78714112l-110.68302222-184.47170332a132.04290333 132.04290333 0 0 1-17.47626667-48.54518557h118.4502511a200.97706667 200.97706667 0 0 1 76.21594113 14.56355556l20.38897777 133.49925888a48.54518557 48.54518557 0 0 0 36.40888888 27.67075555l16.01991111 2.91271112a24.27259221 24.27259221 0 0 1 20.38897778 25.72894889zM997.45185223 463.45481443a194.18074112 194.18074112 0 0 1-38.8361489 116.50844445 24.75804445 24.75804445 0 0 1-36.4088889 0l-34.95253333-34.95253333a24.27259221 24.27259221 0 0 1-2.91271111-30.58346667 97.09036999 97.09036999 0 0 0 0-106.79940665 24.27259221 24.27259221 0 0 1 2.91271111-30.58346666l34.95253333-34.95253334a24.75804445 24.75804445 0 0 1 18.93262223-7.28177777 26.2144 26.2144 0 0 1 17.47626667 9.70903665A194.18074112 194.18074112 0 0 1 997.45185223 463.45481443z m-194.18074112-388.36148111v776.72296335a48.54518557 48.54518557 0 0 1-48.54518556 48.54518443h-28.64165888a48.54518557 48.54518557 0 0 1-33.98163001-14.07810332l-145.63555556-143.20829668A291.27111111 291.27111111 0 0 0 342.57730333 657.63555556H172.18370333a145.63555556 145.63555556 0 0 1-145.63555556-145.63555556v-97.09036999a145.63555556 145.63555556 0 0 1 145.63555556-145.63555556h170.3936a291.27111111 291.27111111 0 0 0 206.31703779-85.43952668l145.63555555-143.20829554a48.54518557 48.54518557 0 0 1 33.98162888-14.07810446H754.72592555a48.54518557 48.54518557 0 0 1 48.54518556 48.54518555z" fill="currentColor"></path>
</svg>
    <span>NOTICE</span>
  </div>
  <div class="widget-body">
    <p>QQ:506611735</p>
  </div>
</section>


      <section class="widget-categorys widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
    <span>CATEGORYS</span>
  </div>
  <div class="widget-body">
    <ul class="categorys-list">
      
    </ul>
  </div>
</section>

      <section class="widget-tags widget-item  layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
    <span>TAGS</span>
  </div>
  <div class="widget-body">
    <div class="tags-cloud">
      
    </div>
  </div>
</section>
    </div>
  </article>
</div>

    <!-- footer container -->
<footer id="footer" class="footer">
  <div class="footer-container">
    
    <div class="social-icons">
      
        
      
        
          <a href="https://www.zhihu.com/people/bang-ji-1" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg t="1587373160860" class="icon icon-zhihu" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M544.949 561.422s0-71.387-34.779-75.050c-34.779-3.663-142.775 0-142.775 0v-219.654h161.078s-1.83-73.219-32.949-73.219h-261.755l43.93-117.148s-65.897 3.663-89.692 45.761-98.844 252.604-98.844 252.604 25.627 10.983 67.726-20.134c42.101-31.116 56.743-86.033 56.743-86.033l76.879-3.663 1.83 223.316s-133.621-1.83-161.078 0c-27.457 1.83-42.101 75.050-42.101 75.050h203.182s-18.307 124.47-69.557 214.164c-53.085 89.692-151.929 161.078-151.929 161.078s71.387 29.287 140.947-10.983c69.557-42.101 120.811-223.316 120.811-223.316l162.912 203.182s14.643-97.013-1.83-124.47c-18.307-27.457-113.49-137.283-113.49-137.283l-42.101 36.607 29.287-120.811h177.552zM587.050 188.010l-1.83 660.793h65.897l23.795 82.37 115.321-82.37h162.912v-660.793h-366.091zM879.92 775.584h-76.879l-97.013 75.050-21.965-75.050h-20.134v-512.527h215.991v512.527z"></path>
</svg>
          </a>
        
      
        
      
        
          <a href="https://github.com/jonathanbest7" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64.6 512c0 195.6 125.4 361.9 300.1 422.9 23.5 5.9 19.9-10.8 19.9-22.2v-77.6c-135.8 15.9-141.3-74-150.5-89-18.5-31.5-61.9-39.5-49-54.5 31-15.9 62.5 4 98.9 58 26.4 39.1 77.9 32.5 104.1 26 5.7-23.5 17.9-44.5 34.7-60.9-140.7-25.2-199.4-111.1-199.4-213.3 0-49.5 16.4-95.1 48.4-131.8-20.4-60.6 1.9-112.4 4.9-120.1 58.2-5.2 118.5 41.6 123.3 45.3 33.1-8.9 70.8-13.7 112.9-13.7 42.4 0 80.3 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.4-43.9 2.9 7.7 24.7 58.3 5.5 118.1 32.5 36.8 49 82.8 49 132.4 0 102.3-59 188.3-200.2 213.2 23.5 23.3 38.1 55.5 38.1 91.1v112.7c0.8 9 0 17.9 15.1 17.9C832.7 877 960.4 709.4 960.4 512.1c0-247.5-200.6-447.9-447.9-447.9C265 64.1 64.6 264.5 64.6 512z"></path>
</svg>
          </a>
        
      
        
      
    </div>
     
    <p>&copy; 2022 <a href="/" target="_blank">Jonathan</a></p>

    

    <p>Powered by <a href="https://hexo.io" target="_blank" rel="noopener noreferrer">Hexo</a> Theme - <a href="https://github.com/miiiku/flex-block" target="_blank" rel="noopener noreferrer author">flex-block</a></p>

    <p>
      <a href="javascript:;" id="theme-light">🌞 浅色</a>
      <a href="javascript:;" id="theme-dark">🌛 深色</a>
      <a href="javascript:;" id="theme-auto">🤖️ 自动</a>
    </p>
  </div>
</footer>
  </div>

  <div class="back-to-top-fixed soft-size--round soft-style--box">
    <svg class="icon icon-back-to-top" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <path d="M725.333333 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8l-213.333333-213.333333c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l213.333333 213.333333c17.066667 17.066667 17.066667 42.666667 0 59.733333C746.666667 422.4 738.133333 426.666667 725.333333 426.666667z"></path>
      <path d="M298.666667 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l213.333333-213.333333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-213.333333 213.333333C320 422.4 311.466667 426.666667 298.666667 426.666667z"></path>
      <path d="M512 896c-25.6 0-42.666667-17.066667-42.666667-42.666667L469.333333 170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667l0 682.666667C554.666667 878.933333 537.6 896 512 896z"></path>
    </svg>
  </div>

  
  <!-- aplayer -->


<!-- dplayer -->




  


  


  




<script src="/js/script.js"></script>


  
  <!-- 尾部用户自定义相关内容 -->
</body>
</html>